{
  "hash": "1caf279e7055a5e39c451b8f96f9adca",
  "result": {
    "markdown": "::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport polars as pl\nimport datamol as dm\n```\n:::\n\n\nUsing datamol - Python library that works with molecules\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndf_ai = pl.read_csv(\"chembl_anti-inf.csv\", sep = \";\")\ndf_ai.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\n    .dataframe td {\n        white-space: pre;\n    }\n\n    .dataframe td {\n        padding-top: 0;\n    }\n\n    .dataframe td {\n        padding-bottom: 0;\n    }\n\n    .dataframe td {\n        line-height: 95%;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<small>shape: (5, 29)</small>\n<thead>\n<tr>\n<th>\nParent Molecule\n</th>\n<th>\nName\n</th>\n<th>\nSynonyms\n</th>\n<th>\nResearch Codes\n</th>\n<th>\nPhase\n</th>\n<th>\nDrug Applicants\n</th>\n<th>\nUSAN Stem\n</th>\n<th>\nUSAN Year\n</th>\n<th>\nUSAN Definition\n</th>\n<th>\nUSAN Stem - Substem\n</th>\n<th>\nFirst Approval\n</th>\n<th>\nATC Codes\n</th>\n<th>\nLevel 4 ATC Codes\n</th>\n<th>\nLevel 3 ATC Codes\n</th>\n<th>\nLevel 2 ATC Codes\n</th>\n<th>\nLevel 1 ATC Codes\n</th>\n<th>\nIndication Class\n</th>\n<th>\nPatent\n</th>\n<th>\nDrug Type\n</th>\n<th>\nPasses Rule of Five\n</th>\n<th>\nFirst In Class\n</th>\n<th>\nChirality\n</th>\n<th>\nProdrug\n</th>\n<th>\nOral\n</th>\n<th>\nParenteral\n</th>\n<th>\nTopical\n</th>\n<th>\nBlack Box\n</th>\n<th>\nAvailability Type\n</th>\n<th>\nSmiles\n</th>\n</tr>\n<tr>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nf64\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n<td>\ni64\n</td>\n<td>\ni64\n</td>\n<td>\nstr\n</td>\n<td>\ni64\n</td>\n<td>\ni64\n</td>\n<td>\ni64\n</td>\n<td>\ni64\n</td>\n<td>\ni64\n</td>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n&quot;CHEMBL374975&quot;\n</td>\n<td>\n&quot;FUSIDIC ACID&quot;\n</td>\n<td>\n&quot;ANHYDROUS FUSI...\n</td>\n<td>\n&quot;CEM-102|NSC-56...\n</td>\n<td>\n4.0\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;1967&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;J01XC01 | S01A...\n</td>\n<td>\n&quot;J01XC - Steroi...\n</td>\n<td>\n&quot;J01X - OTHER A...\n</td>\n<td>\n&quot;J01 - ANTIBACT...\n</td>\n<td>\n&quot;J - ANTIINFECT...\n</td>\n<td>\n&quot;Antibacterial&quot;\n</td>\n<td>\n&quot;None&quot;\n</td>\n<td>\n&quot;1:Synthetic Sm...\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Single Stereoi...\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Unknown&quot;\n</td>\n<td>\n&quot;CC(=O)O[C@H]1C...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CHEMBL130&quot;\n</td>\n<td>\n&quot;CHLORAMPHENICO...\n</td>\n<td>\n&quot;9-HYDROXY-9-PH...\n</td>\n<td>\n&quot;NSC-16331|NSC-...\n</td>\n<td>\n4.0\n</td>\n<td>\n&quot;Ivax Pharmaceu...\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;1950&quot;\n</td>\n<td>\n&quot;S01AA01 | S03A...\n</td>\n<td>\n&quot;S01AA - Antibi...\n</td>\n<td>\n&quot;S01A - ANTIINF...\n</td>\n<td>\n&quot;S01 - OPHTHALM...\n</td>\n<td>\n&quot;S - SENSORY OR...\n</td>\n<td>\n&quot;Antibacterial;...\n</td>\n<td>\n&quot;None&quot;\n</td>\n<td>\n&quot;1:Synthetic Sm...\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Single Stereoi...\n</td>\n<td>\n0\n</td>\n<td>\n1\n</td>\n<td>\n1\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Unknown&quot;\n</td>\n<td>\n&quot;O=C(N[C@H](CO)...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CHEMBL186&quot;\n</td>\n<td>\n&quot;CEFEPIME&quot;\n</td>\n<td>\n&quot;BMY-28142|CEFE...\n</td>\n<td>\n&quot;BMY-28142|J01D...\n</td>\n<td>\n4.0\n</td>\n<td>\n&quot;Samson Medical...\n</td>\n<td>\n&quot;&#x27;cef-&#x27;&quot;\n</td>\n<td>\n&quot;1987&quot;\n</td>\n<td>\n&quot;cephalosporins...\n</td>\n<td>\n&quot;&#x27;cef-(cef-)&#x27;&quot;\n</td>\n<td>\n&quot;1996&quot;\n</td>\n<td>\n&quot;J01DE01&quot;\n</td>\n<td>\n&quot;J01DE - Fourth...\n</td>\n<td>\n&quot;J01D - OTHER B...\n</td>\n<td>\n&quot;J01 - ANTIBACT...\n</td>\n<td>\n&quot;J - ANTIINFECT...\n</td>\n<td>\n&quot;Antibacterial&quot;\n</td>\n<td>\n&quot;None&quot;\n</td>\n<td>\n&quot;1:Synthetic Sm...\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Single Stereoi...\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Prescription O...\n</td>\n<td>\n&quot;CO/N=C(\\C(=O)N...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CHEMBL222645&quot;\n</td>\n<td>\n&quot;FLOXACILLIN&quot;\n</td>\n<td>\n&quot;ABBOFLOX|BRL 2...\n</td>\n<td>\n&quot;BRL 2039|BRL-2...\n</td>\n<td>\n4.0\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;&#x27;-cillin&#x27;&quot;\n</td>\n<td>\n&quot;1972&quot;\n</td>\n<td>\n&quot;penicillins&quot;\n</td>\n<td>\n&quot;&#x27;-cillin(-cill...\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;J01CF05&quot;\n</td>\n<td>\n&quot;J01CF - Beta-l...\n</td>\n<td>\n&quot;J01C - BETA-LA...\n</td>\n<td>\n&quot;J01 - ANTIBACT...\n</td>\n<td>\n&quot;J - ANTIINFECT...\n</td>\n<td>\n&quot;Antibacterial&quot;\n</td>\n<td>\n&quot;None&quot;\n</td>\n<td>\n&quot;1:Synthetic Sm...\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Single Stereoi...\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Unknown&quot;\n</td>\n<td>\n&quot;Cc1onc(-c2c(F)...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CHEMBL2364632&quot;\n</td>\n<td>\n&quot;SARECYCLINE&quot;\n</td>\n<td>\n&quot;P-005672|P0056...\n</td>\n<td>\n&quot;P-005672|P0056...\n</td>\n<td>\n4.0\n</td>\n<td>\n&quot;Almirall Llc&quot;\n</td>\n<td>\n&quot;&#x27;-cycline&#x27;&quot;\n</td>\n<td>\n&quot;2012&quot;\n</td>\n<td>\n&quot;antibiotics (t...\n</td>\n<td>\n&quot;&#x27;-cycline(-cyc...\n</td>\n<td>\n&quot;2018&quot;\n</td>\n<td>\n&quot;J01AA14&quot;\n</td>\n<td>\n&quot;J01AA - Tetrac...\n</td>\n<td>\n&quot;J01A - TETRACY...\n</td>\n<td>\n&quot;J01 - ANTIBACT...\n</td>\n<td>\n&quot;J - ANTIINFECT...\n</td>\n<td>\n&quot;&quot;\n</td>\n<td>\n&quot;US-8318706-B2&quot;\n</td>\n<td>\n&quot;1:Synthetic Sm...\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Single Stereoi...\n</td>\n<td>\n0\n</td>\n<td>\n1\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n0\n</td>\n<td>\n&quot;Prescription O...\n</td>\n<td>\n&quot;CON(C)Cc1ccc(O...\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n#print(df_ai.glimpse())\n```\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndf_ai_name_sm = df_ai.select([\"Name\", \"Smiles\"])\ndf_ai_name_sm.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=46}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\n    .dataframe td {\n        white-space: pre;\n    }\n\n    .dataframe td {\n        padding-top: 0;\n    }\n\n    .dataframe td {\n        padding-bottom: 0;\n    }\n\n    .dataframe td {\n        line-height: 95%;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<small>shape: (5, 2)</small>\n<thead>\n<tr>\n<th>\nName\n</th>\n<th>\nSmiles\n</th>\n</tr>\n<tr>\n<td>\nstr\n</td>\n<td>\nstr\n</td>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n&quot;FUSIDIC ACID&quot;\n</td>\n<td>\n&quot;CC(=O)O[C@H]1C...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CHLORAMPHENICO...\n</td>\n<td>\n&quot;O=C(N[C@H](CO)...\n</td>\n</tr>\n<tr>\n<td>\n&quot;CEFEPIME&quot;\n</td>\n<td>\n&quot;CO/N=C(\\C(=O)N...\n</td>\n</tr>\n<tr>\n<td>\n&quot;FLOXACILLIN&quot;\n</td>\n<td>\n&quot;Cc1onc(-c2c(F)...\n</td>\n</tr>\n<tr>\n<td>\n&quot;SARECYCLINE&quot;\n</td>\n<td>\n&quot;CON(C)Cc1ccc(O...\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n#df_ai.write_csv(\"df_ai.csv\", sep = \",\")\n```\n:::\n\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# Grab all SMILES from df_ai\ndf_ai_sm = df_ai[\"Smiles\"]\n# Load a list of molecules in SMILES\nmol_ls = [dm.to_mol(smile) for smile in df_ai_sm]\n# Convert the list of molecules into 2D images\ndm.to_image(mol_ls, n_cols = 2, mol_size = (900, 900))\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n![](chembl_anti-inf_data_prep_files/figure-html/cell-7-output-1.svg){}\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Extract Murcko scaffolds from mol_ls\nm_scaffolds = [dm.to_scaffold_murcko(mol) for mol in mol_ls]\ndm.to_image(m_scaffolds, mol_size = (400, 400))\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n![](chembl_anti-inf_data_prep_files/figure-html/cell-8-output-1.svg){}\n:::\n:::\n\n\n",
    "supporting": [
      "chembl_anti-inf_data_prep_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}