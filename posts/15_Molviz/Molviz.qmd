---
title: "Molecular visualisation (Molviz) web application"
subtitle: "Using Shiny for Python application framework"
author: Jennifer HY Lin
date: '2023-8-6'
format: html
filters:
  - shinylive
draft: true
categories:
  - Python
  - Datamol
  - Shiny
  - Pandas
  - Polars
  - itables
jupyter: python3
---

*Final deployed web app URL* - https://jhylin.shinyapps.io/molviz_app/


#### **Background - how the app started**

Originally I had an idea of incorporating mols2grid library within Shiny for Python web app framework (after seeing an example of a similar app in Streamlit previously), so I worked on a few ideas, but obviously mols2grid was designed to work inside Jupyter Notebook/Lab and Shiny for Python was only out of alpha at that stage so things were still being developed, and unfortunately mols2grid wasn't directly compatible with the Shiny for Python at that time. I then went away to work on another project on molecular scaffolds and left this mini project aside. However, recently I had another idea of trying to build a Shiny for Python app from the scratch (my first ever app relating to cheminformatics or chemical information), so that users in relevant fields can view and save 2D images of small molecules in a web browser environment instead of only inside a Jupyter Notebook/Lab.

Note: I'm sure this is not the first ever app for this type of use as there are many great apps out there already, but I thought to try out the Shiny for Python framework - to put it to test and show that it should work in the chemistry field.

*Also because of reading a comment from an old RDKit blog post from someone commenting on how to save the compound image as a PNG file.

<br>

#### **Plans**

Plans for app was to provide:

1) An interactive dataframe-like table for compound searches to access different molecular representations for each compound 

2) A sightly more challenging part to show the 2D image representations of each compound via input selections in Shiny for Python app framework

- Shiny for Python web application for viewing & searching dataframe along with 2D images of small molecules of interests available for viewing & saving
- Available functions: viewing, saving and substructure highlighting of target molecules
- Blog post regarding to this work may also show another version of the interactive table (using ITables) in the Jupyter notebook environment (Shinylive app embedding method currently not working for this due to my personal preference of keeping the index column, but app deployment to other platforms should be working - not tested yet though)
- Molviz_app may be deployed via Shinyapps.io or HuggingFace - to be decided (confirmed not to be embedded inside Quarto doc as RDKit does not have pure wheel file since it's not written purely in Python, it's written using Python and C++, therefore Shinylive version will not work)

<br>

#### **About each version of app_x.py scripts**

I'll try to explain what each version of the app_x.py script entails, as there are currently several different versions of them inside the repository. The final version is the one called "app.py", named this way so that it'll be recognised by rsconnect/Shinyapps.io when deploying the app. 

##### **app_x.py**

Explanations/features

##### **app_x.py**

Explanations/features

<br>

#### **Other files**

##### **code_test.py**

I'm not sure exactly how other data scientists/developers work, but for me since I came from a completely different background and training, I'm used to plan, set up and do experiments to test things I'd like to try, and see where the results will lead me to. So for this in a virtual computer setting, I use the "code_tests.py" to test a lot of different code. If you go into this file, then you'll likely see a lot of RDKit code trials, and I have had a lot of fun doing this since I get to see the results right away when running the code, and learning new code functions that way. If the end result is not the one I've intended, I go on short journeys to look for answers (surprisingly I didn't use any generative AI chatbots along the way actually), it'll mainly be chosen intuitively as I search online, but I can for this particular project, a lot of it was past RDKit blogs, StackOverflow and random snippets I came across that have given me ideas about solving a particular issue.

<br>

##### **app_table.py and app_itables.py**

These two as the file names have suggested were trials for incorporating dataframe inside a web app. The difference was that app_table.py was purely a data table being presented inside the app, without any other particular features, while app_itables.py utilised a different package itables that provided an interactive feature to search for data in rows. The previous post on data source used for this app or interactive data table was embedded inside a Quarto document, the same principle would also apply to the table being present inside a Jupyter notebook environment (?Lab as well).

<br>

#### **Features of the app**

Comments from scripts available - check.

<br>

#### **App deployment**

Two places I've tried so far - HuggingFace and Shinyapps.io. 

Issue with cairosvg code when deploying in HuggingFace.

Deploying to Shinyapps.io wasn't a smooth ride as well - some problems initially - explain the steps.

<br>

#### **Further improvements of the app**

May be useful to add a download option for real-world use case, but for demonstration purpose, I'm leaving it as a "View" only for now, unless I get comments from readers that they'd like to try this. For localhost version, the saving image function should work and the files will be saved to the working directory.

It may be even better to use SMARTS or SMILES for highlighting compound substructures actually. I'm using atom indices as I'm using a specific code in RDKit, but perhaps more experienced people with RDKit will know how to add other alternative options.

The app layout may be further optimised e.g. interactive data table could be placed at a different location.

<br>

#### **Final words**

The whole idea behind this mini side project was to show that interested users could use this web app framework to build an interactive app using their own data. Other useful web app frameworks are also available and definitely not limited to the one I'm using here (I'm simply trying to test it out since it's relatively new comparing to others). In a drug discovery and development setting, this could be useful to make non-coding parties understand where the computer side is trying to do, and to help them during their lab experimental workflows, hoping to add some convenience at least.
