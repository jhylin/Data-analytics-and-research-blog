<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer HY Lin">
<meta name="dcterms.date" content="2022-12-19">

<title>Home - Small molecules in ChEMBL database</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5CHVP3K63C"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5CHVP3K63C', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Jennifer HY Lin</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jhylin"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jenhylin"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://jhylin.github.io/CV_resume_quarto/">
 <span class="menu-text">CV</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Small molecules in ChEMBL database</h1>
            <p class="subtitle lead">Polars dataframe library and machine learning in scikit-learn</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Data analytics projects</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Polars</div>
                <div class="quarto-category">Rust</div>
                <div class="quarto-category">Jupyter</div>
                <div class="quarto-category">Cheminformatics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jennifer HY Lin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 19, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background-for-this-python-polars-project" id="toc-background-for-this-python-polars-project" class="nav-link active" data-scroll-target="#background-for-this-python-polars-project"><strong>Background for this Python-Polars project</strong></a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><strong>Data wrangling</strong></a></li>
  <li><a href="#prepare-dataframe-prior-to-running-ml-model" id="toc-prepare-dataframe-prior-to-running-ml-model" class="nav-link" data-scroll-target="#prepare-dataframe-prior-to-running-ml-model"><strong>Prepare dataframe prior to running ML model</strong></a>
  <ul>
  <li><a href="#re-sampling-via-under-sampling" id="toc-re-sampling-via-under-sampling" class="nav-link" data-scroll-target="#re-sampling-via-under-sampling"><strong>Re-sampling via under-sampling</strong></a></li>
  </ul></li>
  <li><a href="#import-libraries-for-ml" id="toc-import-libraries-for-ml" class="nav-link" data-scroll-target="#import-libraries-for-ml"><strong>Import libraries for ML</strong></a></li>
  <li><a href="#logistic-regression-with-scikit-learn" id="toc-logistic-regression-with-scikit-learn" class="nav-link" data-scroll-target="#logistic-regression-with-scikit-learn"><strong>Logistic regression with <em>scikit-learn</em></strong></a>
  <ul>
  <li><a href="#pipeline-method-for-logistic-regression" id="toc-pipeline-method-for-logistic-regression" class="nav-link" data-scroll-target="#pipeline-method-for-logistic-regression"><strong>Pipeline method for logistic regression</strong></a></li>
  </ul></li>
  <li><a href="#evaluation-of-the-logistic-regression-model" id="toc-evaluation-of-the-logistic-regression-model" class="nav-link" data-scroll-target="#evaluation-of-the-logistic-regression-model"><strong>Evaluation of the logistic regression model</strong></a>
  <ul>
  <li><a href="#jaccard-score" id="toc-jaccard-score" class="nav-link" data-scroll-target="#jaccard-score"><strong>Jaccard score</strong></a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix"><strong>Confusion matrix</strong></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jhylin/Data_in_life_blog/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="background-for-this-python-polars-project" class="level4">
<h4 class="anchored" data-anchor-id="background-for-this-python-polars-project"><strong>Background for this Python-Polars project</strong></h4>
<p>As my interests for Rust gradually grew, I realised why so many people said it could be a hard programming language to learn. My head was spinning after reading the Rust programming language book and also watching a few Youtube videos about it. One likely reason could be that I didn’t come from a computer science major.</p>
<p>I’ve then decided to start from something I was more familiar with, which was Jupyter notebook or lab. Then somehow through various online ventures and surfing, I managed to start two projects in parallel. One was where I used Polars, a blazingly fast dataframe library that was written completely in Rust with a very light Python binding. This meant I could utilise it in Python or Rust, so I started with Python version first (obviously), which so far had been very pleasing and indeed fast as it claimed.</p>
<p>This work was purely on small molecules downloaded from the ChEMBL database, and would be detailed in this portfolio blog post.</p>
<p>I began with importing Polars dataframe library as shown below (note: installation needs to occur first prior to this step - detailed steps were available in its GitHub repo) - <strong>add link</strong></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update Polars version</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the following line if needing to update Polars</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade polars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: polars in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (0.15.7)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show version of Polars </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pl.show_versions()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---Version info---
Polars: 0.15.7
Index type: UInt32
Platform: macOS-10.15.7-x86_64-i386-64bit
Python: 3.11.0 (v3.11.0:deaf509e8f, Oct 24 2022, 14:43:23) [Clang 13.0.0 (clang-1300.0.29.30)]
---Optional dependencies---
pyarrow: 10.0.1
pandas: 1.5.2
numpy: 1.23.5
fsspec: &lt;not installed&gt;
connectorx: &lt;not installed&gt;
xlsx2csv: &lt;not installed&gt;
matplotlib: 3.6.2</code></pre>
</div>
</div>
<p>Next step would be to access and download the compound dataset from ChEMBL database. So this was done and the file saved as .csv file, which was imported and read via read_csv() as shown below.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(<span class="st">"chembl_mols.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df.head() <span class="co">#read first 5 rows</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df #read full dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 1)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID";"Name";"Synonyms";"Type";"Max Phase";"Molecular Weight";"Targets";"Bioactivities";"AlogP";"Polar Surface Area";"HBA";"HBD";"#RO5 Violations";"#Rotatable Bonds";"Passes Ro3";"QED Weighted";"CX Acidic pKa";"CX Basic pKa";"CX LogP";"CX LogD";"Aromatic Rings";"Structure Type";"Inorganic Flag";"Heavy Atoms";"HBA (Lipinski)";"HBD (Lipinski)";"#RO5 Violations (Lipinski)";"Molecular Weight (Monoisotopic)";"Molecular Species";"Molecular Formula";"Smiles";"Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1206185;...
</td>
</tr>
<tr>
<td>
"CHEMBL539070;"...
</td>
</tr>
<tr>
<td>
"CHEMBL3335528;...
</td>
</tr>
<tr>
<td>
"CHEMBL2419030;...
</td>
</tr>
<tr>
<td>
"CHEMBL4301448;...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level4">
<h4 class="anchored" data-anchor-id="data-wrangling"><strong>Data wrangling</strong></h4>
<p>Now first problem appeared without surprises as this dataset was downloaded as .csv file, which meant it was likely to have a certain delimiter in between each variable. The dataset showed all data were packed as strings for each compound in each row. Each variable is separated or delimited by semicolons. To read the dataframe properly, I’ve added a delimiter term into the code to transform the dataframe into a more readable format.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Going back to polars documentation, use "sep" to set the delimiter of the file</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which in this case is semicolon</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(<span class="st">"chembl_mols.csv"</span>, sep <span class="op">=</span> <span class="st">";"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the first 10 rows of data</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#df.head(10)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2331700, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1206185"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"607.88"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"9.46"
</td>
<td>
"89.62"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"2"
</td>
<td>
"17"
</td>
<td>
"N"
</td>
<td>
"0.09"
</td>
<td>
"-1.91"
</td>
<td>
"8.38"
</td>
<td>
"9.40"
</td>
<td>
"9.36"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"42"
</td>
<td>
"5"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"607.2790"
</td>
<td>
"ACID"
</td>
<td>
"C35H45NO4S2"
</td>
<td>
"CCCCCCCCCCC#CC...
</td>
<td>
"UFBLKYIDZFRLPR...
</td>
</tr>
<tr>
<td>
"CHEMBL539070"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"286.79"
</td>
<td>
"1"
</td>
<td>
"1"
</td>
<td>
"2.28"
</td>
<td>
"73.06"
</td>
<td>
"6"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"5"
</td>
<td>
"N"
</td>
<td>
"0.63"
</td>
<td>
"13.84"
</td>
<td>
"3.64"
</td>
<td>
"2.57"
</td>
<td>
"2.57"
</td>
<td>
"2"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"17"
</td>
<td>
"5"
</td>
<td>
"3"
</td>
<td>
"0"
</td>
<td>
"250.0888"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C11H15ClN4OS"
</td>
<td>
"CCCOc1ccccc1-c...
</td>
<td>
"WPEWNRKLKLNLSO...
</td>
</tr>
<tr>
<td>
"CHEMBL3335528"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"842.80"
</td>
<td>
"2"
</td>
<td>
"6"
</td>
<td>
"0.18"
</td>
<td>
"269.57"
</td>
<td>
"18"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"17"
</td>
<td>
"N"
</td>
<td>
"0.09"
</td>
<td>
"3.20"
</td>
<td>
"None"
</td>
<td>
"3.31"
</td>
<td>
"-0.14"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"60"
</td>
<td>
"19"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"842.2633"
</td>
<td>
"ACID"
</td>
<td>
"C41H46O19"
</td>
<td>
"COC(=O)[C@H](O...
</td>
<td>
"KGUJQZWYZPYYRZ...
</td>
</tr>
<tr>
<td>
"CHEMBL2419030"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"359.33"
</td>
<td>
"4"
</td>
<td>
"4"
</td>
<td>
"3.94"
</td>
<td>
"85.13"
</td>
<td>
"6"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"3"
</td>
<td>
"N"
</td>
<td>
"0.66"
</td>
<td>
"None"
</td>
<td>
"None"
</td>
<td>
"3.66"
</td>
<td>
"3.66"
</td>
<td>
"2"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"24"
</td>
<td>
"6"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"359.0551"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C14H12F3N3O3S"
</td>
<td>
"O=c1nc(NC2CCCC...
</td>
<td>
"QGDMYSDFCXOKML...
</td>
</tr>
<tr>
<td>
"CHEMBL4301448"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"465.55"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"5.09"
</td>
<td>
"105.28"
</td>
<td>
"6"
</td>
<td>
"4"
</td>
<td>
"1"
</td>
<td>
"10"
</td>
<td>
"N"
</td>
<td>
"0.15"
</td>
<td>
"None"
</td>
<td>
"12.14"
</td>
<td>
"4.41"
</td>
<td>
"2.00"
</td>
<td>
"4"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"33"
</td>
<td>
"7"
</td>
<td>
"5"
</td>
<td>
"1"
</td>
<td>
"465.1635"
</td>
<td>
"BASE"
</td>
<td>
"C24H24FN5O2S"
</td>
<td>
"N=C(N)NCCCOc1c...
</td>
<td>
"RXTJPHLPHOZLFS...
</td>
</tr>
<tr>
<td>
"CHEMBL3827271"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"712.85"
</td>
<td>
"1"
</td>
<td>
"1"
</td>
<td>
"-2.84"
</td>
<td>
"319.06"
</td>
<td>
"10"
</td>
<td>
"11"
</td>
<td>
"2"
</td>
<td>
"16"
</td>
<td>
"N"
</td>
<td>
"0.07"
</td>
<td>
"4.08"
</td>
<td>
"10.49"
</td>
<td>
"-6.88"
</td>
<td>
"-8.95"
</td>
<td>
"0"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"50"
</td>
<td>
"19"
</td>
<td>
"14"
</td>
<td>
"3"
</td>
<td>
"712.4232"
</td>
<td>
"ZWITTERION"
</td>
<td>
"C31H56N10O9"
</td>
<td>
"CC(C)C[C@@H]1N...
</td>
<td>
"QJQNNLICZLLPMB...
</td>
</tr>
<tr>
<td>
"CHEMBL1969944"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
""
</td>
<td>
"56"
</td>
<td>
"56"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"NONE"
</td>
<td>
-1
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
</tr>
<tr>
<td>
"CHEMBL3465961"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"319.42"
</td>
<td>
"16"
</td>
<td>
"22"
</td>
<td>
"2.22"
</td>
<td>
"50.50"
</td>
<td>
"4"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"6"
</td>
<td>
"N"
</td>
<td>
"0.87"
</td>
<td>
"None"
</td>
<td>
"9.38"
</td>
<td>
"2.13"
</td>
<td>
"-0.44"
</td>
<td>
"1"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"23"
</td>
<td>
"4"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"319.2060"
</td>
<td>
"BASE"
</td>
<td>
"C18H26FN3O"
</td>
<td>
"CC(O)CN1CCC(CN...
</td>
<td>
"FZEVYCHTADTXPM...
</td>
</tr>
<tr>
<td>
"CHEMBL587495"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"478.54"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"6.85"
</td>
<td>
"66.73"
</td>
<td>
"4"
</td>
<td>
"3"
</td>
<td>
"1"
</td>
<td>
"6"
</td>
<td>
"N"
</td>
<td>
"0.23"
</td>
<td>
"10.67"
</td>
<td>
"8.47"
</td>
<td>
"6.04"
</td>
<td>
"4.93"
</td>
<td>
"5"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"34"
</td>
<td>
"4"
</td>
<td>
"4"
</td>
<td>
"1"
</td>
<td>
"478.1439"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C26H21F3N4S"
</td>
<td>
"Nc1cccc(CNCc2c...
</td>
<td>
"KZOHKPSNJBXTRJ...
</td>
</tr>
<tr>
<td>
"CHEMBL3824158"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"422.48"
</td>
<td>
"2"
</td>
<td>
"4"
</td>
<td>
"5.09"
</td>
<td>
"109.54"
</td>
<td>
"6"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"10"
</td>
<td>
"N"
</td>
<td>
"0.31"
</td>
<td>
"4.59"
</td>
<td>
"7.99"
</td>
<td>
"2.49"
</td>
<td>
"2.42"
</td>
<td>
"2"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"31"
</td>
<td>
"7"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"422.1842"
</td>
<td>
"ACID"
</td>
<td>
"C24H26N2O5"
</td>
<td>
"CCCCCCCNC(C1=C...
</td>
<td>
"AXOVDUYYBUYLPC...
</td>
</tr>
<tr>
<td>
"CHEMBL194112"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"366.38"
</td>
<td>
"2"
</td>
<td>
"3"
</td>
<td>
"4.80"
</td>
<td>
"57.53"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"1"
</td>
<td>
"N"
</td>
<td>
"0.75"
</td>
<td>
"8.98"
</td>
<td>
"None"
</td>
<td>
"4.84"
</td>
<td>
"4.83"
</td>
<td>
"1"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"26"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"366.1443"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C20H21F3O3"
</td>
<td>
"C[C@]12CCC3c4c...
</td>
<td>
"FIBOSLUEJGPVMK...
</td>
</tr>
<tr>
<td>
"CHEMBL2047226"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"452.40"
</td>
<td>
"4"
</td>
<td>
"8"
</td>
<td>
"4.93"
</td>
<td>
"53.08"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"7"
</td>
<td>
"N"
</td>
<td>
"0.53"
</td>
<td>
"None"
</td>
<td>
"8.47"
</td>
<td>
"4.51"
</td>
<td>
"3.29"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"29"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"451.1372"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C23H26BrN5"
</td>
<td>
"Brc1ccc(CNc2cc...
</td>
<td>
"WOAVNWHCIXCOIZ...
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL387315"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"673.99"
</td>
<td>
"2"
</td>
<td>
"2"
</td>
<td>
"9.83"
</td>
<td>
"43.86"
</td>
<td>
"3"
</td>
<td>
"0"
</td>
<td>
"2"
</td>
<td>
"21"
</td>
<td>
"N"
</td>
<td>
"0.08"
</td>
<td>
"None"
</td>
<td>
"9.57"
</td>
<td>
"10.60"
</td>
<td>
"8.45"
</td>
<td>
"4"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"50"
</td>
<td>
"5"
</td>
<td>
"0"
</td>
<td>
"2"
</td>
<td>
"673.4607"
</td>
<td>
"BASE"
</td>
<td>
"C45H59N3O2"
</td>
<td>
"CCCCCc1ccc(C(=...
</td>
<td>
"HVSKDFHVTFRADD...
</td>
</tr>
<tr>
<td>
"CHEMBL540121"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"540.05"
</td>
<td>
"2"
</td>
<td>
"3"
</td>
<td>
"2.39"
</td>
<td>
"147.14"
</td>
<td>
"6"
</td>
<td>
"4"
</td>
<td>
"1"
</td>
<td>
"8"
</td>
<td>
"N"
</td>
<td>
"0.22"
</td>
<td>
"5.02"
</td>
<td>
"11.48"
</td>
<td>
"-0.75"
</td>
<td>
"-0.78"
</td>
<td>
"4"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"36"
</td>
<td>
"9"
</td>
<td>
"5"
</td>
<td>
"1"
</td>
<td>
"503.1627"
</td>
<td>
"ZWITTERION"
</td>
<td>
"C26H26ClN5O4S"
</td>
<td>
"Cc1ccn(NS(=O)(...
</td>
<td>
"TZLGWENJAJXWGA...
</td>
</tr>
<tr>
<td>
"CHEMBL2387650"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"496.01"
</td>
<td>
"2"
</td>
<td>
"13"
</td>
<td>
"6.03"
</td>
<td>
"66.84"
</td>
<td>
"5"
</td>
<td>
"1"
</td>
<td>
"1"
</td>
<td>
"7"
</td>
<td>
"N"
</td>
<td>
"0.32"
</td>
<td>
"3.57"
</td>
<td>
"None"
</td>
<td>
"6.77"
</td>
<td>
"3.42"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"33"
</td>
<td>
"5"
</td>
<td>
"1"
</td>
<td>
"1"
</td>
<td>
"495.0366"
</td>
<td>
"ACID"
</td>
<td>
"C25H18ClNO4S2"
</td>
<td>
"O=C(O)[C@@H](C...
</td>
<td>
"LSYQEQADGPAMNF...
</td>
</tr>
<tr>
<td>
"CHEMBL374041"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"504.50"
</td>
<td>
"2"
</td>
<td>
"4"
</td>
<td>
"3.04"
</td>
<td>
"144.95"
</td>
<td>
"8"
</td>
<td>
"3"
</td>
<td>
"1"
</td>
<td>
"10"
</td>
<td>
"N"
</td>
<td>
"0.28"
</td>
<td>
"6.59"
</td>
<td>
"4.37"
</td>
<td>
"2.17"
</td>
<td>
"1.33"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"37"
</td>
<td>
"11"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"504.1645"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C26H24N4O7"
</td>
<td>
"CCOCCC1(Oc2ccc...
</td>
<td>
"ABCSNHDQYHOLOO...
</td>
</tr>
<tr>
<td>
"CHEMBL394794"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"707.86"
</td>
<td>
"1"
</td>
<td>
"2"
</td>
<td>
"4.31"
</td>
<td>
"183.99"
</td>
<td>
"12"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"9"
</td>
<td>
"N"
</td>
<td>
"0.18"
</td>
<td>
"12.10"
</td>
<td>
"None"
</td>
<td>
"3.09"
</td>
<td>
"3.09"
</td>
<td>
"0"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"50"
</td>
<td>
"13"
</td>
<td>
"3"
</td>
<td>
"2"
</td>
<td>
"707.3881"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C37H57NO12"
</td>
<td>
"C=C1[C@@H](O)C...
</td>
<td>
"CFMSPOHWBQUTHN...
</td>
</tr>
<tr>
<td>
"CHEMBL2035815"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"534.89"
</td>
<td>
"10"
</td>
<td>
"10"
</td>
<td>
"4.46"
</td>
<td>
"146.01"
</td>
<td>
"10"
</td>
<td>
"3"
</td>
<td>
"1"
</td>
<td>
"8"
</td>
<td>
"N"
</td>
<td>
"0.28"
</td>
<td>
"None"
</td>
<td>
"6.22"
</td>
<td>
"3.48"
</td>
<td>
"3.48"
</td>
<td>
"4"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"37"
</td>
<td>
"11"
</td>
<td>
"4"
</td>
<td>
"2"
</td>
<td>
"534.1142"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C22H18ClF3N8O3...
</td>
<td>
"C=CC(=O)NCc1co...
</td>
<td>
"ZRZKVZZVULTROL...
</td>
</tr>
<tr>
<td>
"CHEMBL1586325"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"425.47"
</td>
<td>
"6"
</td>
<td>
"7"
</td>
<td>
"3.11"
</td>
<td>
"109.62"
</td>
<td>
"5"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"8"
</td>
<td>
"N"
</td>
<td>
"0.44"
</td>
<td>
"13.84"
</td>
<td>
"None"
</td>
<td>
"3.24"
</td>
<td>
"3.24"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"30"
</td>
<td>
"8"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"425.1045"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C21H19N3O5S"
</td>
<td>
"O=C(CN(c1cccc(...
</td>
<td>
"XVDMUGUIAWGPNU...
</td>
</tr>
<tr>
<td>
"CHEMBL2017916"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"312.35"
</td>
<td>
"3"
</td>
<td>
"3"
</td>
<td>
"2.86"
</td>
<td>
"77.00"
</td>
<td>
"6"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"4"
</td>
<td>
"N"
</td>
<td>
"0.80"
</td>
<td>
"8.13"
</td>
<td>
"3.49"
</td>
<td>
"2.17"
</td>
<td>
"2.10"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"22"
</td>
<td>
"6"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"312.0681"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H12N4O2S"
</td>
<td>
"COc1ccc(-c2nnc...
</td>
<td>
"XIZUJGDKNPVNQA...
</td>
</tr>
<tr>
<td>
"CHEMBL374652"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"403.83"
</td>
<td>
"1"
</td>
<td>
"1"
</td>
<td>
"5.98"
</td>
<td>
"36.02"
</td>
<td>
"2"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"4"
</td>
<td>
"N"
</td>
<td>
"0.42"
</td>
<td>
"13.65"
</td>
<td>
"None"
</td>
<td>
"5.36"
</td>
<td>
"5.36"
</td>
<td>
"3"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"26"
</td>
<td>
"2"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"403.0421"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H14ClF4NOS"
</td>
<td>
"CC(O)(CSc1ccc(...
</td>
<td>
"CRPQTBRTHURKII...
</td>
</tr>
<tr>
<td>
"CHEMBL1416264"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"380.41"
</td>
<td>
"6"
</td>
<td>
"8"
</td>
<td>
"3.06"
</td>
<td>
"85.07"
</td>
<td>
"7"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"5"
</td>
<td>
"N"
</td>
<td>
"0.54"
</td>
<td>
"13.85"
</td>
<td>
"3.86"
</td>
<td>
"2.47"
</td>
<td>
"2.47"
</td>
<td>
"4"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"27"
</td>
<td>
"7"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"380.0856"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H13FN6OS"
</td>
<td>
"O=C(CSc1ccc2nn...
</td>
<td>
"QVYIEKHEJKFNAT...
</td>
</tr>
<tr>
<td>
"CHEMBL213734"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"288.26"
</td>
<td>
"2"
</td>
<td>
"3"
</td>
<td>
"2.32"
</td>
<td>
"101.70"
</td>
<td>
"5"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"5"
</td>
<td>
"N"
</td>
<td>
"0.50"
</td>
<td>
"7.20"
</td>
<td>
"None"
</td>
<td>
"2.36"
</td>
<td>
"1.95"
</td>
<td>
"2"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"21"
</td>
<td>
"7"
</td>
<td>
"2"
</td>
<td>
"0"
</td>
<td>
"288.0746"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C14H12N2O5"
</td>
<td>
"O=C(COc1ccccc1...
</td>
<td>
"PZTWAHGBGTWVEB...
</td>
</tr>
<tr>
<td>
"CHEMBL1531634"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
"320.16"
</td>
<td>
"19"
</td>
<td>
"21"
</td>
<td>
"4.40"
</td>
<td>
"29.10"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"4"
</td>
<td>
"N"
</td>
<td>
"0.67"
</td>
<td>
"None"
</td>
<td>
"None"
</td>
<td>
"4.04"
</td>
<td>
"4.04"
</td>
<td>
"2"
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
"19"
</td>
<td>
"2"
</td>
<td>
"1"
</td>
<td>
"0"
</td>
<td>
"319.0008"
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H11BrFNO"
</td>
<td>
"O=C(/C=C/Nc1cc...
</td>
<td>
"DKPWCCDDKFLKEC...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Initially, I only wanted to download about 24 compounds from ChEMBL database to trial first. Unknowingly, I ended up downloading the whole curated set of 2,331,700 small molecules (!), and I found this out when I loaded the dataframe after setting the delimiter for the csv file. Loading these 2,331,700 rows of data was fast, which occurred within a few seconds. This echoed many users’ experiences with Polars, so I was quite impressed with Rust actually, as this was the core programming language used to write the dataframe library.</p>
<p>So now there was the full dataframe, I wanted to find out what types of physicochemical properties were there.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print all column names and data types to see what compound properties are stored in chEMBL database</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.glimpse())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2331700
Columns: 32
$ ChEMBL ID                        &lt;Utf8&gt; CHEMBL1206185, CHEMBL539070, CHEMBL3335528, CHEMBL2419030, CHEMBL4301448, CHEMBL3827271, CHEMBL1969944, CHEMBL3465961, CHEMBL587495, CHEMBL3824158
$ Name                             &lt;Utf8&gt; , , , , , , , , ,                                             
$ Synonyms                         &lt;Utf8&gt; , , , , , , , , ,                                             
$ Type                             &lt;Utf8&gt; Small molecule, Small molecule, Small molecule, Small molecule, Small molecule, Small molecule, Small molecule, Small molecule, Small molecule, Small molecule
$ Max Phase                       &lt;Int64&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0                                  
$ Molecular Weight                 &lt;Utf8&gt; 607.88, 286.79, 842.80, 359.33, 465.55, 712.85, , 319.42, 478.54, 422.48
$ Targets                          &lt;Utf8&gt; , 1, 2, 4, , 1, 56, 16, , 2                                   
$ Bioactivities                    &lt;Utf8&gt; , 1, 6, 4, , 1, 56, 22, , 4                                   
$ AlogP                            &lt;Utf8&gt; 9.46, 2.28, 0.18, 3.94, 5.09, -2.84, , 2.22, 6.85, 5.09       
$ Polar Surface Area               &lt;Utf8&gt; 89.62, 73.06, 269.57, 85.13, 105.28, 319.06, , 50.50, 66.73, 109.54
$ HBA                              &lt;Utf8&gt; 5, 6, 18, 6, 6, 10, , 4, 4, 6                                 
$ HBD                              &lt;Utf8&gt; 2, 2, 5, 1, 4, 11, , 1, 3, 2                                  
$ #RO5 Violations                  &lt;Utf8&gt; 2, 0, 2, 0, 1, 2, , 0, 1, 1                                   
$ #Rotatable Bonds                 &lt;Utf8&gt; 17, 5, 17, 3, 10, 16, , 6, 6, 10                              
$ Passes Ro3                       &lt;Utf8&gt; N, N, N, N, N, N, , N, N, N                                   
$ QED Weighted                     &lt;Utf8&gt; 0.09, 0.63, 0.09, 0.66, 0.15, 0.07, , 0.87, 0.23, 0.31        
$ CX Acidic pKa                    &lt;Utf8&gt; -1.91, 13.84, 3.20, None, None, 4.08, , None, 10.67, 4.59     
$ CX Basic pKa                     &lt;Utf8&gt; 8.38, 3.64, None, None, 12.14, 10.49, , 9.38, 8.47, 7.99      
$ CX LogP                          &lt;Utf8&gt; 9.40, 2.57, 3.31, 3.66, 4.41, -6.88, , 2.13, 6.04, 2.49       
$ CX LogD                          &lt;Utf8&gt; 9.36, 2.57, -0.14, 3.66, 2.00, -8.95, , -0.44, 4.93, 2.42     
$ Aromatic Rings                   &lt;Utf8&gt; 3, 2, 3, 2, 4, 0, , 1, 5, 2                                   
$ Structure Type                   &lt;Utf8&gt; MOL, MOL, MOL, MOL, MOL, MOL, NONE, MOL, MOL, MOL             
$ Inorganic Flag                  &lt;Int64&gt; -1, -1, -1, -1, -1, -1, -1, -1, -1, -1                        
$ Heavy Atoms                      &lt;Utf8&gt; 42, 17, 60, 24, 33, 50, , 23, 34, 31                          
$ HBA (Lipinski)                   &lt;Utf8&gt; 5, 5, 19, 6, 7, 19, , 4, 4, 7                                 
$ HBD (Lipinski)                   &lt;Utf8&gt; 3, 3, 5, 1, 5, 14, , 1, 4, 2                                  
$ #RO5 Violations (Lipinski)       &lt;Utf8&gt; 2, 0, 2, 0, 1, 3, , 0, 1, 1                                   
$ Molecular Weight (Monoisotopic)  &lt;Utf8&gt; 607.2790, 250.0888, 842.2633, 359.0551, 465.1635, 712.4232, , 319.2060, 478.1439, 422.1842
$ Molecular Species                &lt;Utf8&gt; ACID, NEUTRAL, ACID, NEUTRAL, BASE, ZWITTERION, , BASE, NEUTRAL, ACID
$ Molecular Formula                &lt;Utf8&gt; C35H45NO4S2, C11H15ClN4OS, C41H46O19, C14H12F3N3O3S, C24H24FN5O2S, C31H56N10O9, , C18H26FN3O, C26H21F3N4S, C24H26N2O5
$ Smiles                           &lt;Utf8&gt; CCCCCCCCCCC#CC(N)c1ccccc1-c1ccc(Sc2ccc(OCCCC)cc2)c(S(=O)(=O)O)c1, CCCOc1ccccc1-c1nnc(NN)s1.Cl, COC(=O)[C@H](O[C@@H]1O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]1O)[C@@H](O[C@@H]1O[C@H](CO)[C@H](OC(=O)c2ccccc2)[C@H](O[C@H](Cc2ccccc2)C(=O)O)[C@H]1OC(=O)c1ccccc1)C(=O)OC, O=c1nc(NC2CCCC2)sc2c([N+](=O)[O-])cc(C(F)(F)F)cc12, N=C(N)NCCCOc1ccc(CNc2nc3ccc(Oc4ccc(F)cc4)cc3s2)cc1, CC(C)C[C@@H]1NC(=O)[C@H](CCCNC(N)=O)NC(=O)[C@H](CCCCN)NC(=O)[C@H](CC(=O)O)NC(=O)[C@H](CCCCN)NC(=O)CCNC1=O, , CC(O)CN1CCC(CN(C)Cc2cc(C#N)ccc2F)CC1, Nc1cccc(CNCc2ccc(-c3ccc(-c4nc5cc(C(F)(F)F)ccc5[nH]4)s3)cc2)c1, CCCCCCCNC(C1=C(O)C(=O)c2ccccc2C1=O)c1ccc([N+](=O)[O-])cc1
$ Inchi Key                        &lt;Utf8&gt; UFBLKYIDZFRLPR-UHFFFAOYSA-N, WPEWNRKLKLNLSO-UHFFFAOYSA-N, KGUJQZWYZPYYRZ-LWEWUKDVSA-N, QGDMYSDFCXOKML-UHFFFAOYSA-N, RXTJPHLPHOZLFS-UHFFFAOYSA-N, QJQNNLICZLLPMB-VUBDRERZSA-N, , FZEVYCHTADTXPM-UHFFFAOYSA-N, KZOHKPSNJBXTRJ-UHFFFAOYSA-N, AXOVDUYYBUYLPC-UHFFFAOYSA-N
</code></pre>
</div>
</div>
<p>A separate dataframe was saved as df_col_list to show all the column names used, which reflected the physicochemical properties of all the small molecules curated by ChEMBL database. There were a few I wasn’t sure of so I went through the ChEMBL_31 schema documentation and ChEMBL database website to find out.</p>
<p>Selected definitions of the physicochemical properties of compounds were adapted from ChEMBL_31 schema documentation (available as “Release notes” on website), or if not available from the documentation, I resorted to interpret them myself by going into compounds randomly in that particular physicochemical category on ChEMBL database (e.g.&nbsp;bioactivities was not included in the documentation).</p>
<p>The definitions for these properties were shown below:</p>
<p>‘Max Phase’ - Maximum phase of development reached for the compound (4 = approved). Null where max phase has not yet been assigned.</p>
<p>‘Bioactivities’ - Various biological assays used for the compounds e.g.&nbsp;IC50s, GI50s, potency tests etc.</p>
<p>‘AlogP’ - Calculated partition coefficient</p>
<p>‘HBA’ - Number of hydrogen bond acceptors</p>
<p>‘HBD’ - Number of hydrogen bond donors</p>
<p>‘#RO5 Violations’ - Number of violations of Lipinski’s rule-of-five, using HBA and HBD definitions</p>
<p>‘Passes Ro3’ - Indicates whether the compound passes the rule-of-three (mw &lt; 300, logP &lt; 3 etc)</p>
<p>‘QED Weighted’ - Weighted quantitative estimate of drug likeness (as defined by Bickerton et al., Nature Chem 2012)</p>
<p>‘Inorganic flag’ - Indicates whether the molecule is inorganic (i.e., containing only metal atoms and &lt;2 carbon atoms), where 1 = inorganic compound and -1 = not inorganic compound (assume 0 means it’s neither case or yet to be assigned)</p>
<p>‘Heavy Atoms’ - Number of heavy (non-hydrogen) atoms</p>
<p>‘CX Acidic pKa’ - The most acidic pKa calculated using ChemAxon v17.29.0</p>
<p>‘CX Basic pKa’ - The most basic pKa calculated using ChemAxon v17.29.0</p>
<p>‘CX LogP’ - The calculated octanol/water partition coefficient using ChemAxon v17.29.0</p>
<p>‘CX LogD’ - The calculated octanol/water distribution coefficient at pH7.4 using ChemAxon v17.29.0</p>
<p>‘Structure Type’ - based on compound_structures table, where SEQ indicates an entry in the protein_therapeutics table instead, NONE indicates an entry in neither tables, e.g.&nbsp;structure unknown</p>
<p>‘Inchi Key’ - the IUPAC international chemical identifier key</p>
<p>Now, next step was also quite important, which was to check the data types for each column in the dataset.</p>
<p>So from what I could see, a lot of the columns were of data type “Utf8” (with only two columns that had “Int64”), which meant they were strings. However, a lot of these columns were actually storing numbers as integers or floats. So to make my life easier for this project, I then went on to convert these data types to the relevant ones for these columns.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data types for multiple selected columns</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: only takes two positional arguments, so needed to use the [] in code to change </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple columns all at once (use alias if wanting to keep original data type in column, </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as it adds the new column under an alias name to dataframe</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df.with_columns(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Molecular Weight"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Targets"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Bioactivities"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"AlogP"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Polar Surface Area"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBA"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBD"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#RO5 Violations"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#Rotatable Bonds"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"QED Weighted"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX Acidic pKa"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX Basic pKa"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX LogP"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX LogD"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Aromatic Rings"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Heavy Atoms"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBA (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBD (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#RO5 Violations (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Molecular Weight (Monoisotopic)"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>df_new.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1206185"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
607.88
</td>
<td>
null
</td>
<td>
null
</td>
<td>
9.46
</td>
<td>
89.62
</td>
<td>
5
</td>
<td>
2
</td>
<td>
2
</td>
<td>
17
</td>
<td>
"N"
</td>
<td>
0.09
</td>
<td>
-1.91
</td>
<td>
8.38
</td>
<td>
9.4
</td>
<td>
9.36
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
42
</td>
<td>
5
</td>
<td>
3
</td>
<td>
2
</td>
<td>
607.279
</td>
<td>
"ACID"
</td>
<td>
"C35H45NO4S2"
</td>
<td>
"CCCCCCCCCCC#CC...
</td>
<td>
"UFBLKYIDZFRLPR...
</td>
</tr>
<tr>
<td>
"CHEMBL539070"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
286.79
</td>
<td>
1
</td>
<td>
1
</td>
<td>
2.28
</td>
<td>
73.06
</td>
<td>
6
</td>
<td>
2
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.63
</td>
<td>
13.84
</td>
<td>
3.64
</td>
<td>
2.57
</td>
<td>
2.57
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
17
</td>
<td>
5
</td>
<td>
3
</td>
<td>
0
</td>
<td>
250.0888
</td>
<td>
"NEUTRAL"
</td>
<td>
"C11H15ClN4OS"
</td>
<td>
"CCCOc1ccccc1-c...
</td>
<td>
"WPEWNRKLKLNLSO...
</td>
</tr>
<tr>
<td>
"CHEMBL3335528"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
842.8
</td>
<td>
2
</td>
<td>
6
</td>
<td>
0.18
</td>
<td>
269.57
</td>
<td>
18
</td>
<td>
5
</td>
<td>
2
</td>
<td>
17
</td>
<td>
"N"
</td>
<td>
0.09
</td>
<td>
3.2
</td>
<td>
null
</td>
<td>
3.31
</td>
<td>
-0.14
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
60
</td>
<td>
19
</td>
<td>
5
</td>
<td>
2
</td>
<td>
842.2633
</td>
<td>
"ACID"
</td>
<td>
"C41H46O19"
</td>
<td>
"COC(=O)[C@H](O...
</td>
<td>
"KGUJQZWYZPYYRZ...
</td>
</tr>
<tr>
<td>
"CHEMBL2419030"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
359.33
</td>
<td>
4
</td>
<td>
4
</td>
<td>
3.94
</td>
<td>
85.13
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.66
</td>
<td>
null
</td>
<td>
null
</td>
<td>
3.66
</td>
<td>
3.66
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
24
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
359.0551
</td>
<td>
"NEUTRAL"
</td>
<td>
"C14H12F3N3O3S"
</td>
<td>
"O=c1nc(NC2CCCC...
</td>
<td>
"QGDMYSDFCXOKML...
</td>
</tr>
<tr>
<td>
"CHEMBL4301448"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
465.55
</td>
<td>
null
</td>
<td>
null
</td>
<td>
5.09
</td>
<td>
105.28
</td>
<td>
6
</td>
<td>
4
</td>
<td>
1
</td>
<td>
10
</td>
<td>
"N"
</td>
<td>
0.15
</td>
<td>
null
</td>
<td>
12.14
</td>
<td>
4.41
</td>
<td>
2.0
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
33
</td>
<td>
7
</td>
<td>
5
</td>
<td>
1
</td>
<td>
465.1635
</td>
<td>
"BASE"
</td>
<td>
"C24H24FN5O2S"
</td>
<td>
"N=C(N)NCCCOc1c...
</td>
<td>
"RXTJPHLPHOZLFS...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Once all the columns’ data types have been checked and converted to appropriate types accordingly, I used null_count() to see the distributions of all null entries in the dataset.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any null or NA or "" entries in the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative line that works similarly is df.select(pl.all().null_count())</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_new.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
23249
</td>
<td>
96223
</td>
<td>
96223
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
0
</td>
<td>
83571
</td>
<td>
1052439
</td>
<td>
882168
</td>
<td>
83795
</td>
<td>
83795
</td>
<td>
83571
</td>
<td>
0
</td>
<td>
0
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
83571
</td>
<td>
23252
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with null entries</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_dn <span class="op">=</span> df_new.drop_nulls()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df_dn </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of rows reduced to 736,570</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (736570, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL539070"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
286.79
</td>
<td>
1
</td>
<td>
1
</td>
<td>
2.28
</td>
<td>
73.06
</td>
<td>
6
</td>
<td>
2
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.63
</td>
<td>
13.84
</td>
<td>
3.64
</td>
<td>
2.57
</td>
<td>
2.57
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
17
</td>
<td>
5
</td>
<td>
3
</td>
<td>
0
</td>
<td>
250.0888
</td>
<td>
"NEUTRAL"
</td>
<td>
"C11H15ClN4OS"
</td>
<td>
"CCCOc1ccccc1-c...
</td>
<td>
"WPEWNRKLKLNLSO...
</td>
</tr>
<tr>
<td>
"CHEMBL3827271"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
712.85
</td>
<td>
1
</td>
<td>
1
</td>
<td>
-2.84
</td>
<td>
319.06
</td>
<td>
10
</td>
<td>
11
</td>
<td>
2
</td>
<td>
16
</td>
<td>
"N"
</td>
<td>
0.07
</td>
<td>
4.08
</td>
<td>
10.49
</td>
<td>
-6.88
</td>
<td>
-8.95
</td>
<td>
0
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
50
</td>
<td>
19
</td>
<td>
14
</td>
<td>
3
</td>
<td>
712.4232
</td>
<td>
"ZWITTERION"
</td>
<td>
"C31H56N10O9"
</td>
<td>
"CC(C)C[C@@H]1N...
</td>
<td>
"QJQNNLICZLLPMB...
</td>
</tr>
<tr>
<td>
"CHEMBL3824158"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
422.48
</td>
<td>
2
</td>
<td>
4
</td>
<td>
5.09
</td>
<td>
109.54
</td>
<td>
6
</td>
<td>
2
</td>
<td>
1
</td>
<td>
10
</td>
<td>
"N"
</td>
<td>
0.31
</td>
<td>
4.59
</td>
<td>
7.99
</td>
<td>
2.49
</td>
<td>
2.42
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
31
</td>
<td>
7
</td>
<td>
2
</td>
<td>
1
</td>
<td>
422.1842
</td>
<td>
"ACID"
</td>
<td>
"C24H26N2O5"
</td>
<td>
"CCCCCCCNC(C1=C...
</td>
<td>
"AXOVDUYYBUYLPC...
</td>
</tr>
<tr>
<td>
"CHEMBL1991010"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
454.05
</td>
<td>
60
</td>
<td>
60
</td>
<td>
5.18
</td>
<td>
40.54
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.6
</td>
<td>
13.88
</td>
<td>
8.48
</td>
<td>
6.34
</td>
<td>
5.22
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
31
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
417.2668
</td>
<td>
"NEUTRAL"
</td>
<td>
"C28H36ClNO2"
</td>
<td>
"CCc1ccc(/C=C/C...
</td>
<td>
"XJDPAUYFONOZBC...
</td>
</tr>
<tr>
<td>
"CHEMBL195644"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
375.47
</td>
<td>
2
</td>
<td>
3
</td>
<td>
4.95
</td>
<td>
70.42
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
2
</td>
<td>
"N"
</td>
<td>
0.73
</td>
<td>
9.52
</td>
<td>
3.73
</td>
<td>
3.92
</td>
<td>
3.91
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
28
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
375.1834
</td>
<td>
"NEUTRAL"
</td>
<td>
"C24H25NO3"
</td>
<td>
"C[C@]12CCC3c4c...
</td>
<td>
"MOBPUUUBXAHZBM...
</td>
</tr>
<tr>
<td>
"CHEMBL255263"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
388.42
</td>
<td>
4
</td>
<td>
4
</td>
<td>
2.42
</td>
<td>
95.16
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.72
</td>
<td>
11.24
</td>
<td>
1.02
</td>
<td>
1.74
</td>
<td>
1.74
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
27
</td>
<td>
7
</td>
<td>
2
</td>
<td>
0
</td>
<td>
388.1005
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H17FN4O3S"
</td>
<td>
"O=C(Cc1ccc(F)c...
</td>
<td>
"JXSGQHRSUUOSAF...
</td>
</tr>
<tr>
<td>
"CHEMBL504846"
</td>
<td>
""
</td>
<td>
"25-Deacetyl-Ri...
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
807.0
</td>
<td>
3
</td>
<td>
21
</td>
<td>
3.9
</td>
<td>
202.64
</td>
<td>
13
</td>
<td>
7
</td>
<td>
3
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.23
</td>
<td>
8.61
</td>
<td>
8.27
</td>
<td>
3.4
</td>
<td>
2.87
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
58
</td>
<td>
14
</td>
<td>
7
</td>
<td>
3
</td>
<td>
806.4466
</td>
<td>
"NEUTRAL"
</td>
<td>
"C44H62N4O10"
</td>
<td>
"CO[C@H]1/C=C/O...
</td>
<td>
"MVUYPJALSSDCQB...
</td>
</tr>
<tr>
<td>
"CHEMBL85010"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
508.96
</td>
<td>
4
</td>
<td>
5
</td>
<td>
2.65
</td>
<td>
139.21
</td>
<td>
9
</td>
<td>
3
</td>
<td>
1
</td>
<td>
7
</td>
<td>
"N"
</td>
<td>
0.22
</td>
<td>
7.03
</td>
<td>
2.71
</td>
<td>
3.27
</td>
<td>
2.75
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
35
</td>
<td>
10
</td>
<td>
3
</td>
<td>
1
</td>
<td>
508.1612
</td>
<td>
"NEUTRAL"
</td>
<td>
"C24H29ClN2O8"
</td>
<td>
"CCOCCNC(=O)CO/...
</td>
<td>
"PHPBXALSGRFDIK...
</td>
</tr>
<tr>
<td>
"CHEMBL1364151"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
314.39
</td>
<td>
5
</td>
<td>
6
</td>
<td>
2.5
</td>
<td>
54.56
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.88
</td>
<td>
13.45
</td>
<td>
7.28
</td>
<td>
2.38
</td>
<td>
2.14
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
23
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
314.163
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H22N2O3"
</td>
<td>
"Cc1[nH]c2ccccc...
</td>
<td>
"OKIWVYPITFJCJI...
</td>
</tr>
<tr>
<td>
"CHEMBL2047203"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
855.36
</td>
<td>
5
</td>
<td>
6
</td>
<td>
7.45
</td>
<td>
272.16
</td>
<td>
10
</td>
<td>
4
</td>
<td>
2
</td>
<td>
13
</td>
<td>
"N"
</td>
<td>
0.06
</td>
<td>
-10.58
</td>
<td>
5.78
</td>
<td>
4.35
</td>
<td>
4.11
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
61
</td>
<td>
20
</td>
<td>
4
</td>
<td>
3
</td>
<td>
854.3492
</td>
<td>
"ACID"
</td>
<td>
"C40H47ClN14O6"
</td>
<td>
"COC(=O)N[C@H](...
</td>
<td>
"QDXJQBSKIKHCKU...
</td>
</tr>
<tr>
<td>
"CHEMBL3798157"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
455.45
</td>
<td>
28
</td>
<td>
64
</td>
<td>
4.77
</td>
<td>
105.24
</td>
<td>
6
</td>
<td>
3
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.4
</td>
<td>
7.29
</td>
<td>
3.02
</td>
<td>
3.97
</td>
<td>
3.64
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
32
</td>
<td>
8
</td>
<td>
3
</td>
<td>
0
</td>
<td>
455.0864
</td>
<td>
"NEUTRAL"
</td>
<td>
"C21H15F2N5O3S"
</td>
<td>
"CNC(=O)c1cc(Oc...
</td>
<td>
"LADWERPDOVRXBZ...
</td>
</tr>
<tr>
<td>
"CHEMBL1337107"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
296.33
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2.29
</td>
<td>
64.35
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.75
</td>
<td>
12.82
</td>
<td>
4.35
</td>
<td>
2.35
</td>
<td>
2.35
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
22
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
296.1161
</td>
<td>
"NEUTRAL"
</td>
<td>
"C17H16N2O3"
</td>
<td>
"COC(=O)Cn1c(C(...
</td>
<td>
"SBCXFZQMSVPTPA...
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL255122"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
529.07
</td>
<td>
1
</td>
<td>
2
</td>
<td>
2.81
</td>
<td>
110.43
</td>
<td>
6
</td>
<td>
3
</td>
<td>
1
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.47
</td>
<td>
12.29
</td>
<td>
6.33
</td>
<td>
1.68
</td>
<td>
1.65
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
3
</td>
<td>
1
</td>
<td>
528.171
</td>
<td>
"NEUTRAL"
</td>
<td>
"C25H29ClN6O3S"
</td>
<td>
"CCC(=O)N1CCC(N...
</td>
<td>
"RAMXCQDJYLSGRA...
</td>
</tr>
<tr>
<td>
"CHEMBL2018776"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
516.04
</td>
<td>
5
</td>
<td>
5
</td>
<td>
6.1
</td>
<td>
97.84
</td>
<td>
8
</td>
<td>
2
</td>
<td>
2
</td>
<td>
13
</td>
<td>
"N"
</td>
<td>
0.26
</td>
<td>
12.76
</td>
<td>
9.18
</td>
<td>
5.66
</td>
<td>
3.88
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
2
</td>
<td>
2
</td>
<td>
515.2299
</td>
<td>
"BASE"
</td>
<td>
"C26H34ClN5O4"
</td>
<td>
"CCCCOc1cc2c(Nc...
</td>
<td>
"FARPVPMCEBTTDI...
</td>
</tr>
<tr>
<td>
"CHEMBL97207"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
286.12
</td>
<td>
2
</td>
<td>
2
</td>
<td>
1.31
</td>
<td>
99.82
</td>
<td>
5
</td>
<td>
2
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.89
</td>
<td>
13.08
</td>
<td>
0.38
</td>
<td>
2.1
</td>
<td>
2.1
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
18
</td>
<td>
6
</td>
<td>
4
</td>
<td>
0
</td>
<td>
285.0184
</td>
<td>
"NEUTRAL"
</td>
<td>
"C10H9Cl2N5O"
</td>
<td>
"NC(=O)c1nnn(Cc...
</td>
<td>
"HULYRQSWFVUVSF...
</td>
</tr>
<tr>
<td>
"CHEMBL221343"
</td>
<td>
""
</td>
<td>
"LUF-5980"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
313.4
</td>
<td>
5
</td>
<td>
7
</td>
<td>
5.42
</td>
<td>
41.57
</td>
<td>
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.55
</td>
<td>
11.75
</td>
<td>
3.12
</td>
<td>
5.46
</td>
<td>
5.46
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
24
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
313.1579
</td>
<td>
"NEUTRAL"
</td>
<td>
"C21H19N3"
</td>
<td>
"CC(C)c1nc2c(-c...
</td>
<td>
"REXYMDQLBZWOMA...
</td>
</tr>
<tr>
<td>
"CHEMBL1420018"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
255.27
</td>
<td>
15
</td>
<td>
20
</td>
<td>
2.31
</td>
<td>
69.39
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.52
</td>
<td>
13.72
</td>
<td>
2.76
</td>
<td>
2.38
</td>
<td>
2.38
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
19
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
255.0895
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H13NO3"
</td>
<td>
"Nc1cccc(C(=O)O...
</td>
<td>
"UTIDKUVFKVXYLT...
</td>
</tr>
<tr>
<td>
"CHEMBL2314244"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
470.61
</td>
<td>
7
</td>
<td>
9
</td>
<td>
1.86
</td>
<td>
122.72
</td>
<td>
6
</td>
<td>
6
</td>
<td>
1
</td>
<td>
17
</td>
<td>
"N"
</td>
<td>
0.2
</td>
<td>
8.96
</td>
<td>
10.81
</td>
<td>
-0.72
</td>
<td>
-3.93
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
34
</td>
<td>
8
</td>
<td>
6
</td>
<td>
1
</td>
<td>
470.2893
</td>
<td>
"BASE"
</td>
<td>
"C26H38N4O4"
</td>
<td>
"O=C(Cc1ccccc1O...
</td>
<td>
"SUKXUTUXGGJIBX...
</td>
</tr>
<tr>
<td>
"CHEMBL1420130"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
226.3
</td>
<td>
2
</td>
<td>
2
</td>
<td>
1.89
</td>
<td>
63.08
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.63
</td>
<td>
12.05
</td>
<td>
1.31
</td>
<td>
2.94
</td>
<td>
2.94
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
15
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
226.0776
</td>
<td>
"NEUTRAL"
</td>
<td>
"C10H14N2O2S"
</td>
<td>
"CC(C)(C)C(=O)C...
</td>
<td>
"LCGAKQAOOABKRG...
</td>
</tr>
<tr>
<td>
"CHEMBL2419480"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
456.52
</td>
<td>
3
</td>
<td>
3
</td>
<td>
1.56
</td>
<td>
129.46
</td>
<td>
8
</td>
<td>
1
</td>
<td>
0
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.59
</td>
<td>
3.99
</td>
<td>
1.9
</td>
<td>
2.14
</td>
<td>
1.2
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
32
</td>
<td>
9
</td>
<td>
1
</td>
<td>
0
</td>
<td>
456.1467
</td>
<td>
"ACID"
</td>
<td>
"C22H24N4O5S"
</td>
<td>
"CCOC(=O)c1cc(C...
</td>
<td>
"TXYSLOQUANFYQS...
</td>
</tr>
<tr>
<td>
"CHEMBL540121"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
540.05
</td>
<td>
2
</td>
<td>
3
</td>
<td>
2.39
</td>
<td>
147.14
</td>
<td>
6
</td>
<td>
4
</td>
<td>
1
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.22
</td>
<td>
5.02
</td>
<td>
11.48
</td>
<td>
-0.75
</td>
<td>
-0.78
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
5
</td>
<td>
1
</td>
<td>
503.1627
</td>
<td>
"ZWITTERION"
</td>
<td>
"C26H26ClN5O4S"
</td>
<td>
"Cc1ccn(NS(=O)(...
</td>
<td>
"TZLGWENJAJXWGA...
</td>
</tr>
<tr>
<td>
"CHEMBL374041"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
504.5
</td>
<td>
2
</td>
<td>
4
</td>
<td>
3.04
</td>
<td>
144.95
</td>
<td>
8
</td>
<td>
3
</td>
<td>
1
</td>
<td>
10
</td>
<td>
"N"
</td>
<td>
0.28
</td>
<td>
6.59
</td>
<td>
4.37
</td>
<td>
2.17
</td>
<td>
1.33
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
37
</td>
<td>
11
</td>
<td>
3
</td>
<td>
2
</td>
<td>
504.1645
</td>
<td>
"NEUTRAL"
</td>
<td>
"C26H24N4O7"
</td>
<td>
"CCOCCC1(Oc2ccc...
</td>
<td>
"ABCSNHDQYHOLOO...
</td>
</tr>
<tr>
<td>
"CHEMBL2017916"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
312.35
</td>
<td>
3
</td>
<td>
3
</td>
<td>
2.86
</td>
<td>
77.0
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.8
</td>
<td>
8.13
</td>
<td>
3.49
</td>
<td>
2.17
</td>
<td>
2.1
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
22
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
312.0681
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H12N4O2S"
</td>
<td>
"COc1ccc(-c2nnc...
</td>
<td>
"XIZUJGDKNPVNQA...
</td>
</tr>
<tr>
<td>
"CHEMBL1416264"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
380.41
</td>
<td>
6
</td>
<td>
8
</td>
<td>
3.06
</td>
<td>
85.07
</td>
<td>
7
</td>
<td>
1
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.54
</td>
<td>
13.85
</td>
<td>
3.86
</td>
<td>
2.47
</td>
<td>
2.47
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
27
</td>
<td>
7
</td>
<td>
1
</td>
<td>
0
</td>
<td>
380.0856
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H13FN6OS"
</td>
<td>
"O=C(CSc1ccc2nn...
</td>
<td>
"QVYIEKHEJKFNAT...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that all rows with null values were dropped</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_dn.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To see summary statistics for df_dn dataset</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_dn.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (7, 33)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
describe
</th>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"count"
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
"736570"
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
"736570"
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
736570.0
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
<td>
"736570"
</td>
</tr>
<tr>
<td>
"null_count"
</td>
<td>
"0"
</td>
<td>
"0"
</td>
<td>
"0"
</td>
<td>
"0"
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
"0"
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
"0"
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
"0"
</td>
<td>
"0"
</td>
<td>
"0"
</td>
<td>
"0"
</td>
</tr>
<tr>
<td>
"mean"
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
0.007937
</td>
<td>
431.880042
</td>
<td>
5.520715
</td>
<td>
8.705471
</td>
<td>
3.325204
</td>
<td>
97.58116
</td>
<td>
5.890221
</td>
<td>
2.274721
</td>
<td>
0.489124
</td>
<td>
6.216262
</td>
<td>
null
</td>
<td>
0.510936
</td>
<td>
9.59944
</td>
<td>
5.074377
</td>
<td>
2.815115
</td>
<td>
2.17363
</td>
<td>
2.754412
</td>
<td>
null
</td>
<td>
-0.929521
</td>
<td>
30.266113
</td>
<td>
7.276555
</td>
<td>
2.497847
</td>
<td>
0.576319
</td>
<td>
428.334452
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"std"
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
0.164565
</td>
<td>
135.637543
</td>
<td>
14.784793
</td>
<td>
55.537836
</td>
<td>
1.980414
</td>
<td>
47.40847
</td>
<td>
2.459106
</td>
<td>
1.681943
</td>
<td>
0.794171
</td>
<td>
3.894505
</td>
<td>
null
</td>
<td>
0.229039
</td>
<td>
3.583639
</td>
<td>
3.234099
</td>
<td>
2.286325
</td>
<td>
2.645694
</td>
<td>
1.2009
</td>
<td>
null
</td>
<td>
0.255953
</td>
<td>
9.54406
</td>
<td>
3.067158
</td>
<td>
2.081485
</td>
<td>
0.908719
</td>
<td>
133.755653
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"min"
</td>
<td>
"CHEMBL10"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
""
</td>
<td>
0.0
</td>
<td>
45.04
</td>
<td>
1.0
</td>
<td>
1.0
</td>
<td>
-12.92
</td>
<td>
3.24
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
"N"
</td>
<td>
0.01
</td>
<td>
-20.03
</td>
<td>
0.0
</td>
<td>
-16.71
</td>
<td>
-26.04
</td>
<td>
0.0
</td>
<td>
"BOTH"
</td>
<td>
-1.0
</td>
<td>
3.0
</td>
<td>
1.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
45.0215
</td>
<td>
"ACID"
</td>
<td>
"C10H10Br2N2O"
</td>
<td>
"Br.Br.C/C(=N/N...
</td>
<td>
"AAAADVYFXUUVEO...
</td>
</tr>
<tr>
<td>
"max"
</td>
<td>
"CHEMBL99998"
</td>
<td>
"t-4-AMINOCROTO...
</td>
<td>
"trovafloxacin9...
</td>
<td>
"Unknown"
</td>
<td>
4.0
</td>
<td>
1901.51
</td>
<td>
1334.0
</td>
<td>
17911.0
</td>
<td>
16.83
</td>
<td>
595.22
</td>
<td>
32.0
</td>
<td>
25.0
</td>
<td>
4.0
</td>
<td>
59.0
</td>
<td>
"Y"
</td>
<td>
0.95
</td>
<td>
14.0
</td>
<td>
38.8
</td>
<td>
18.31
</td>
<td>
18.31
</td>
<td>
28.0
</td>
<td>
"MOL"
</td>
<td>
0.0
</td>
<td>
76.0
</td>
<td>
34.0
</td>
<td>
32.0
</td>
<td>
4.0
</td>
<td>
999.4063
</td>
<td>
"ZWITTERION"
</td>
<td>
"HNNa2O8S2"
</td>
<td>
"n1nc2c([nH]1)c...
</td>
<td>
"ZZZZEJJXQQRZBH...
</td>
</tr>
<tr>
<td>
"median"
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
0.0
</td>
<td>
413.46
</td>
<td>
2.0
</td>
<td>
3.0
</td>
<td>
3.37
</td>
<td>
88.32
</td>
<td>
5.0
</td>
<td>
2.0
</td>
<td>
0.0
</td>
<td>
5.0
</td>
<td>
null
</td>
<td>
0.51
</td>
<td>
10.51
</td>
<td>
4.7
</td>
<td>
2.97
</td>
<td>
2.46
</td>
<td>
3.0
</td>
<td>
null
</td>
<td>
-1.0
</td>
<td>
29.0
</td>
<td>
7.0
</td>
<td>
2.0
</td>
<td>
0.0
</td>
<td>
410.2066
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
<td>
null
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>One of the columns that jumped out from the summary statistics of the df_dn dataset, was the “Targets” column. It ranged from 1 to 1334 targets. Out of curiosity, I went through several places on ChEMBL website to find out the exact definition of “Target”. Eventually I settled on an answer which explained that the “Target” column represented the number of targets associated with the particular ChEMBL compound listed. I then singled out the ChEMBL compound with 1334 targets recorded, it turned out to be imatinib, which was marketed as Gleevec, and was a well-known prescription medicine for leukaemia and other selected oncological disorders with many well-documented drug interactions.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This was confirmed via a filter function, which brought up CHEMBL1421, or also known as dasatinib</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_dn.<span class="bu">filter</span>(pl.col(<span class="st">"Targets"</span>) <span class="op">==</span> <span class="dv">1334</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL941"
</td>
<td>
"IMATINIB"
</td>
<td>
"GLAMOX|Gleevec...
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
493.62
</td>
<td>
1334
</td>
<td>
4359
</td>
<td>
4.59
</td>
<td>
86.28
</td>
<td>
7
</td>
<td>
2
</td>
<td>
0
</td>
<td>
7
</td>
<td>
"N"
</td>
<td>
0.39
</td>
<td>
12.69
</td>
<td>
7.84
</td>
<td>
4.38
</td>
<td>
3.8
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
0
</td>
<td>
37
</td>
<td>
8
</td>
<td>
2
</td>
<td>
0
</td>
<td>
493.259
</td>
<td>
"NEUTRAL"
</td>
<td>
"C29H31N7O"
</td>
<td>
"Cc1ccc(NC(=O)c...
</td>
<td>
"KTUFNOKKBVMGRW...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To explore other physicochemical and molecular properties in the dataframe, “Max Phase” was one of the first few that drew my interests. So it tagged each ChEMBL compound with a max phase number from 0 to 4, where 4 meant the compound was approved (usually also meant it was already a precription medicine). Thinking along this line, I thought what about those compounds that had max phase as 0, because they were the ones still pending to be assigned with a max phase number tag. So here I thought this might be a good time to introduce some machine learning model, to predict whether these 0 max phase compounds would enter the approved max phase.</p>
<p>Firstly, I had a look at the overall distribution of the max phase compounds in this dataframe df_dn.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interested in what types of "Max Phase" were recorded for the curated small molecules in ChEMBL database</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_dn.groupby(<span class="st">"Max Phase"</span>, maintain_order <span class="op">=</span> <span class="va">True</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (5, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Max Phase
</th>
<th>
count
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
734633
</td>
</tr>
<tr>
<td>
3
</td>
<td>
303
</td>
</tr>
<tr>
<td>
4
</td>
<td>
954
</td>
</tr>
<tr>
<td>
2
</td>
<td>
441
</td>
</tr>
<tr>
<td>
1
</td>
<td>
239
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A quick groupby function showed that there were only 954 small molecules approved. Phase 3 recorded a total of 303 small molecules. For phase 2, there were 441 small molecules, followed by 239 compounds in phase 1. There were, however, a total amount of 734,633 small molecules that had zero or null as phase number, that were still pending for a max phase number (as per ChEMBL_31 schema documentation).</p>
<p>One of the other parameters I was interested in was “QED Weighted”. So I went further into understanding what it meant, as the original reference was nicely provided in the ChEMBL_31 schema documentation. The reference paper was by <a href="https://doi.org/10.1038/nchem.1243">Bickerton, G., Paolini, G., Besnard, J. et al.&nbsp;Quantifying the chemical beauty of drugs. Nature Chem 4, 90–98 (2012)</a>(note: author’s manuscript is available to view via PubMed link, the Nature Chemistry link only provides abstract with access to article via other means as stated). In simple words, it was a measure of druglikeness for small molecules based on the concept of desirability, which is based on a total of 8 different molecular properties. These molecular properties included: molecular weight, ALogP, polar surface area, number of hydrogen bond acceptors, number of hydrogen bond donors, number of rotatable bonds, number of aromatic rings and structural alerts. Without going into too much details for this QED Weighted parameter, it is normally recorded as a number that ranges from 0 to 1, with 0 being the least druglike and 1 being the most druglike.</p>
</section>
<section id="prepare-dataframe-prior-to-running-ml-model" class="level4">
<h4 class="anchored" data-anchor-id="prepare-dataframe-prior-to-running-ml-model"><strong>Prepare dataframe prior to running ML model</strong></h4>
<p>A rough plan at this stage was to filter out Max Phase 4 and 0 compounds. Max phase 0 compounds were the ones that were not assigned with any max phase numbers yet, so I thought this would be ideal to be used as part of the testing set. The idea was to use “Max Phase” parameter as the target y variable for a logistic regression model, because ultimately stakeholders would be most interested in which candidate compounds would have the most likely potentials to reach the approved stage during the drug discovery and development pipeline, with the smallest possible amount of resources and time needed, in order to provide the greatest public benefit. The goal of this ML model was to answer the question: which physicochemical parameters would be the most suitable ones to predict whether a compound will enter max phase 4 (approved) or not?</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To see full df_dn dataframe only</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_dn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (736570, 32)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Name
</th>
<th>
Synonyms
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
Molecular Weight
</th>
<th>
Targets
</th>
<th>
Bioactivities
</th>
<th>
AlogP
</th>
<th>
Polar Surface Area
</th>
<th>
HBA
</th>
<th>
HBD
</th>
<th>
#RO5 Violations
</th>
<th>
#Rotatable Bonds
</th>
<th>
Passes Ro3
</th>
<th>
QED Weighted
</th>
<th>
CX Acidic pKa
</th>
<th>
CX Basic pKa
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Aromatic Rings
</th>
<th>
Structure Type
</th>
<th>
Inorganic Flag
</th>
<th>
Heavy Atoms
</th>
<th>
HBA (Lipinski)
</th>
<th>
HBD (Lipinski)
</th>
<th>
#RO5 Violations (Lipinski)
</th>
<th>
Molecular Weight (Monoisotopic)
</th>
<th>
Molecular Species
</th>
<th>
Molecular Formula
</th>
<th>
Smiles
</th>
<th>
Inchi Key
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL539070"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
286.79
</td>
<td>
1
</td>
<td>
1
</td>
<td>
2.28
</td>
<td>
73.06
</td>
<td>
6
</td>
<td>
2
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.63
</td>
<td>
13.84
</td>
<td>
3.64
</td>
<td>
2.57
</td>
<td>
2.57
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
17
</td>
<td>
5
</td>
<td>
3
</td>
<td>
0
</td>
<td>
250.0888
</td>
<td>
"NEUTRAL"
</td>
<td>
"C11H15ClN4OS"
</td>
<td>
"CCCOc1ccccc1-c...
</td>
<td>
"WPEWNRKLKLNLSO...
</td>
</tr>
<tr>
<td>
"CHEMBL3827271"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
712.85
</td>
<td>
1
</td>
<td>
1
</td>
<td>
-2.84
</td>
<td>
319.06
</td>
<td>
10
</td>
<td>
11
</td>
<td>
2
</td>
<td>
16
</td>
<td>
"N"
</td>
<td>
0.07
</td>
<td>
4.08
</td>
<td>
10.49
</td>
<td>
-6.88
</td>
<td>
-8.95
</td>
<td>
0
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
50
</td>
<td>
19
</td>
<td>
14
</td>
<td>
3
</td>
<td>
712.4232
</td>
<td>
"ZWITTERION"
</td>
<td>
"C31H56N10O9"
</td>
<td>
"CC(C)C[C@@H]1N...
</td>
<td>
"QJQNNLICZLLPMB...
</td>
</tr>
<tr>
<td>
"CHEMBL3824158"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
422.48
</td>
<td>
2
</td>
<td>
4
</td>
<td>
5.09
</td>
<td>
109.54
</td>
<td>
6
</td>
<td>
2
</td>
<td>
1
</td>
<td>
10
</td>
<td>
"N"
</td>
<td>
0.31
</td>
<td>
4.59
</td>
<td>
7.99
</td>
<td>
2.49
</td>
<td>
2.42
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
31
</td>
<td>
7
</td>
<td>
2
</td>
<td>
1
</td>
<td>
422.1842
</td>
<td>
"ACID"
</td>
<td>
"C24H26N2O5"
</td>
<td>
"CCCCCCCNC(C1=C...
</td>
<td>
"AXOVDUYYBUYLPC...
</td>
</tr>
<tr>
<td>
"CHEMBL1991010"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
454.05
</td>
<td>
60
</td>
<td>
60
</td>
<td>
5.18
</td>
<td>
40.54
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.6
</td>
<td>
13.88
</td>
<td>
8.48
</td>
<td>
6.34
</td>
<td>
5.22
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
31
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
417.2668
</td>
<td>
"NEUTRAL"
</td>
<td>
"C28H36ClNO2"
</td>
<td>
"CCc1ccc(/C=C/C...
</td>
<td>
"XJDPAUYFONOZBC...
</td>
</tr>
<tr>
<td>
"CHEMBL195644"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
375.47
</td>
<td>
2
</td>
<td>
3
</td>
<td>
4.95
</td>
<td>
70.42
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
2
</td>
<td>
"N"
</td>
<td>
0.73
</td>
<td>
9.52
</td>
<td>
3.73
</td>
<td>
3.92
</td>
<td>
3.91
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
28
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
375.1834
</td>
<td>
"NEUTRAL"
</td>
<td>
"C24H25NO3"
</td>
<td>
"C[C@]12CCC3c4c...
</td>
<td>
"MOBPUUUBXAHZBM...
</td>
</tr>
<tr>
<td>
"CHEMBL255263"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
388.42
</td>
<td>
4
</td>
<td>
4
</td>
<td>
2.42
</td>
<td>
95.16
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.72
</td>
<td>
11.24
</td>
<td>
1.02
</td>
<td>
1.74
</td>
<td>
1.74
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
27
</td>
<td>
7
</td>
<td>
2
</td>
<td>
0
</td>
<td>
388.1005
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H17FN4O3S"
</td>
<td>
"O=C(Cc1ccc(F)c...
</td>
<td>
"JXSGQHRSUUOSAF...
</td>
</tr>
<tr>
<td>
"CHEMBL504846"
</td>
<td>
""
</td>
<td>
"25-Deacetyl-Ri...
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
807.0
</td>
<td>
3
</td>
<td>
21
</td>
<td>
3.9
</td>
<td>
202.64
</td>
<td>
13
</td>
<td>
7
</td>
<td>
3
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.23
</td>
<td>
8.61
</td>
<td>
8.27
</td>
<td>
3.4
</td>
<td>
2.87
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
58
</td>
<td>
14
</td>
<td>
7
</td>
<td>
3
</td>
<td>
806.4466
</td>
<td>
"NEUTRAL"
</td>
<td>
"C44H62N4O10"
</td>
<td>
"CO[C@H]1/C=C/O...
</td>
<td>
"MVUYPJALSSDCQB...
</td>
</tr>
<tr>
<td>
"CHEMBL85010"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
508.96
</td>
<td>
4
</td>
<td>
5
</td>
<td>
2.65
</td>
<td>
139.21
</td>
<td>
9
</td>
<td>
3
</td>
<td>
1
</td>
<td>
7
</td>
<td>
"N"
</td>
<td>
0.22
</td>
<td>
7.03
</td>
<td>
2.71
</td>
<td>
3.27
</td>
<td>
2.75
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
35
</td>
<td>
10
</td>
<td>
3
</td>
<td>
1
</td>
<td>
508.1612
</td>
<td>
"NEUTRAL"
</td>
<td>
"C24H29ClN2O8"
</td>
<td>
"CCOCCNC(=O)CO/...
</td>
<td>
"PHPBXALSGRFDIK...
</td>
</tr>
<tr>
<td>
"CHEMBL1364151"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
314.39
</td>
<td>
5
</td>
<td>
6
</td>
<td>
2.5
</td>
<td>
54.56
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.88
</td>
<td>
13.45
</td>
<td>
7.28
</td>
<td>
2.38
</td>
<td>
2.14
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
23
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
314.163
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H22N2O3"
</td>
<td>
"Cc1[nH]c2ccccc...
</td>
<td>
"OKIWVYPITFJCJI...
</td>
</tr>
<tr>
<td>
"CHEMBL2047203"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
855.36
</td>
<td>
5
</td>
<td>
6
</td>
<td>
7.45
</td>
<td>
272.16
</td>
<td>
10
</td>
<td>
4
</td>
<td>
2
</td>
<td>
13
</td>
<td>
"N"
</td>
<td>
0.06
</td>
<td>
-10.58
</td>
<td>
5.78
</td>
<td>
4.35
</td>
<td>
4.11
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
61
</td>
<td>
20
</td>
<td>
4
</td>
<td>
3
</td>
<td>
854.3492
</td>
<td>
"ACID"
</td>
<td>
"C40H47ClN14O6"
</td>
<td>
"COC(=O)N[C@H](...
</td>
<td>
"QDXJQBSKIKHCKU...
</td>
</tr>
<tr>
<td>
"CHEMBL3798157"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
455.45
</td>
<td>
28
</td>
<td>
64
</td>
<td>
4.77
</td>
<td>
105.24
</td>
<td>
6
</td>
<td>
3
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.4
</td>
<td>
7.29
</td>
<td>
3.02
</td>
<td>
3.97
</td>
<td>
3.64
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
32
</td>
<td>
8
</td>
<td>
3
</td>
<td>
0
</td>
<td>
455.0864
</td>
<td>
"NEUTRAL"
</td>
<td>
"C21H15F2N5O3S"
</td>
<td>
"CNC(=O)c1cc(Oc...
</td>
<td>
"LADWERPDOVRXBZ...
</td>
</tr>
<tr>
<td>
"CHEMBL1337107"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
296.33
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2.29
</td>
<td>
64.35
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.75
</td>
<td>
12.82
</td>
<td>
4.35
</td>
<td>
2.35
</td>
<td>
2.35
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
22
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
296.1161
</td>
<td>
"NEUTRAL"
</td>
<td>
"C17H16N2O3"
</td>
<td>
"COC(=O)Cn1c(C(...
</td>
<td>
"SBCXFZQMSVPTPA...
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL255122"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
529.07
</td>
<td>
1
</td>
<td>
2
</td>
<td>
2.81
</td>
<td>
110.43
</td>
<td>
6
</td>
<td>
3
</td>
<td>
1
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.47
</td>
<td>
12.29
</td>
<td>
6.33
</td>
<td>
1.68
</td>
<td>
1.65
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
3
</td>
<td>
1
</td>
<td>
528.171
</td>
<td>
"NEUTRAL"
</td>
<td>
"C25H29ClN6O3S"
</td>
<td>
"CCC(=O)N1CCC(N...
</td>
<td>
"RAMXCQDJYLSGRA...
</td>
</tr>
<tr>
<td>
"CHEMBL2018776"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
516.04
</td>
<td>
5
</td>
<td>
5
</td>
<td>
6.1
</td>
<td>
97.84
</td>
<td>
8
</td>
<td>
2
</td>
<td>
2
</td>
<td>
13
</td>
<td>
"N"
</td>
<td>
0.26
</td>
<td>
12.76
</td>
<td>
9.18
</td>
<td>
5.66
</td>
<td>
3.88
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
2
</td>
<td>
2
</td>
<td>
515.2299
</td>
<td>
"BASE"
</td>
<td>
"C26H34ClN5O4"
</td>
<td>
"CCCCOc1cc2c(Nc...
</td>
<td>
"FARPVPMCEBTTDI...
</td>
</tr>
<tr>
<td>
"CHEMBL97207"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
286.12
</td>
<td>
2
</td>
<td>
2
</td>
<td>
1.31
</td>
<td>
99.82
</td>
<td>
5
</td>
<td>
2
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.89
</td>
<td>
13.08
</td>
<td>
0.38
</td>
<td>
2.1
</td>
<td>
2.1
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
18
</td>
<td>
6
</td>
<td>
4
</td>
<td>
0
</td>
<td>
285.0184
</td>
<td>
"NEUTRAL"
</td>
<td>
"C10H9Cl2N5O"
</td>
<td>
"NC(=O)c1nnn(Cc...
</td>
<td>
"HULYRQSWFVUVSF...
</td>
</tr>
<tr>
<td>
"CHEMBL221343"
</td>
<td>
""
</td>
<td>
"LUF-5980"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
313.4
</td>
<td>
5
</td>
<td>
7
</td>
<td>
5.42
</td>
<td>
41.57
</td>
<td>
2
</td>
<td>
1
</td>
<td>
1
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.55
</td>
<td>
11.75
</td>
<td>
3.12
</td>
<td>
5.46
</td>
<td>
5.46
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
24
</td>
<td>
3
</td>
<td>
1
</td>
<td>
1
</td>
<td>
313.1579
</td>
<td>
"NEUTRAL"
</td>
<td>
"C21H19N3"
</td>
<td>
"CC(C)c1nc2c(-c...
</td>
<td>
"REXYMDQLBZWOMA...
</td>
</tr>
<tr>
<td>
"CHEMBL1420018"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
255.27
</td>
<td>
15
</td>
<td>
20
</td>
<td>
2.31
</td>
<td>
69.39
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.52
</td>
<td>
13.72
</td>
<td>
2.76
</td>
<td>
2.38
</td>
<td>
2.38
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
19
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0
</td>
<td>
255.0895
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H13NO3"
</td>
<td>
"Nc1cccc(C(=O)O...
</td>
<td>
"UTIDKUVFKVXYLT...
</td>
</tr>
<tr>
<td>
"CHEMBL2314244"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
470.61
</td>
<td>
7
</td>
<td>
9
</td>
<td>
1.86
</td>
<td>
122.72
</td>
<td>
6
</td>
<td>
6
</td>
<td>
1
</td>
<td>
17
</td>
<td>
"N"
</td>
<td>
0.2
</td>
<td>
8.96
</td>
<td>
10.81
</td>
<td>
-0.72
</td>
<td>
-3.93
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
34
</td>
<td>
8
</td>
<td>
6
</td>
<td>
1
</td>
<td>
470.2893
</td>
<td>
"BASE"
</td>
<td>
"C26H38N4O4"
</td>
<td>
"O=C(Cc1ccccc1O...
</td>
<td>
"SUKXUTUXGGJIBX...
</td>
</tr>
<tr>
<td>
"CHEMBL1420130"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
226.3
</td>
<td>
2
</td>
<td>
2
</td>
<td>
1.89
</td>
<td>
63.08
</td>
<td>
5
</td>
<td>
1
</td>
<td>
0
</td>
<td>
3
</td>
<td>
"N"
</td>
<td>
0.63
</td>
<td>
12.05
</td>
<td>
1.31
</td>
<td>
2.94
</td>
<td>
2.94
</td>
<td>
1
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
15
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0
</td>
<td>
226.0776
</td>
<td>
"NEUTRAL"
</td>
<td>
"C10H14N2O2S"
</td>
<td>
"CC(C)(C)C(=O)C...
</td>
<td>
"LCGAKQAOOABKRG...
</td>
</tr>
<tr>
<td>
"CHEMBL2419480"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
456.52
</td>
<td>
3
</td>
<td>
3
</td>
<td>
1.56
</td>
<td>
129.46
</td>
<td>
8
</td>
<td>
1
</td>
<td>
0
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.59
</td>
<td>
3.99
</td>
<td>
1.9
</td>
<td>
2.14
</td>
<td>
1.2
</td>
<td>
2
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
32
</td>
<td>
9
</td>
<td>
1
</td>
<td>
0
</td>
<td>
456.1467
</td>
<td>
"ACID"
</td>
<td>
"C22H24N4O5S"
</td>
<td>
"CCOC(=O)c1cc(C...
</td>
<td>
"TXYSLOQUANFYQS...
</td>
</tr>
<tr>
<td>
"CHEMBL540121"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
540.05
</td>
<td>
2
</td>
<td>
3
</td>
<td>
2.39
</td>
<td>
147.14
</td>
<td>
6
</td>
<td>
4
</td>
<td>
1
</td>
<td>
8
</td>
<td>
"N"
</td>
<td>
0.22
</td>
<td>
5.02
</td>
<td>
11.48
</td>
<td>
-0.75
</td>
<td>
-0.78
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
36
</td>
<td>
9
</td>
<td>
5
</td>
<td>
1
</td>
<td>
503.1627
</td>
<td>
"ZWITTERION"
</td>
<td>
"C26H26ClN5O4S"
</td>
<td>
"Cc1ccn(NS(=O)(...
</td>
<td>
"TZLGWENJAJXWGA...
</td>
</tr>
<tr>
<td>
"CHEMBL374041"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
504.5
</td>
<td>
2
</td>
<td>
4
</td>
<td>
3.04
</td>
<td>
144.95
</td>
<td>
8
</td>
<td>
3
</td>
<td>
1
</td>
<td>
10
</td>
<td>
"N"
</td>
<td>
0.28
</td>
<td>
6.59
</td>
<td>
4.37
</td>
<td>
2.17
</td>
<td>
1.33
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
37
</td>
<td>
11
</td>
<td>
3
</td>
<td>
2
</td>
<td>
504.1645
</td>
<td>
"NEUTRAL"
</td>
<td>
"C26H24N4O7"
</td>
<td>
"CCOCCC1(Oc2ccc...
</td>
<td>
"ABCSNHDQYHOLOO...
</td>
</tr>
<tr>
<td>
"CHEMBL2017916"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
312.35
</td>
<td>
3
</td>
<td>
3
</td>
<td>
2.86
</td>
<td>
77.0
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4
</td>
<td>
"N"
</td>
<td>
0.8
</td>
<td>
8.13
</td>
<td>
3.49
</td>
<td>
2.17
</td>
<td>
2.1
</td>
<td>
3
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
22
</td>
<td>
6
</td>
<td>
1
</td>
<td>
0
</td>
<td>
312.0681
</td>
<td>
"NEUTRAL"
</td>
<td>
"C15H12N4O2S"
</td>
<td>
"COc1ccc(-c2nnc...
</td>
<td>
"XIZUJGDKNPVNQA...
</td>
</tr>
<tr>
<td>
"CHEMBL1416264"
</td>
<td>
""
</td>
<td>
""
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
380.41
</td>
<td>
6
</td>
<td>
8
</td>
<td>
3.06
</td>
<td>
85.07
</td>
<td>
7
</td>
<td>
1
</td>
<td>
0
</td>
<td>
5
</td>
<td>
"N"
</td>
<td>
0.54
</td>
<td>
13.85
</td>
<td>
3.86
</td>
<td>
2.47
</td>
<td>
2.47
</td>
<td>
4
</td>
<td>
"MOL"
</td>
<td>
-1
</td>
<td>
27
</td>
<td>
7
</td>
<td>
1
</td>
<td>
0
</td>
<td>
380.0856
</td>
<td>
"NEUTRAL"
</td>
<td>
"C18H13FN6OS"
</td>
<td>
"O=C(CSc1ccc2nn...
</td>
<td>
"QVYIEKHEJKFNAT...
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Narrow down df_dn dataset to fulfill the following criteria: * only small molecule type * max phase of 0 and 4</p>
<p>The reason behind choosing only small molecules that had max phase of 0 and 4 was that a confusion matrix can be built in the end to see if the parameters selected would give us a reasonably good model to predict whether the next small molecule would enter into the approved or max phase of development. For now, I’ve chosen the following columns (by using the select() method) to appear in this interim df_f dataset.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_0 <span class="op">=</span> df_dn.<span class="bu">filter</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Type"</span>) <span class="op">==</span> <span class="st">"Small molecule"</span>) <span class="op">&amp;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    ((pl.col(<span class="st">"Max Phase"</span>) <span class="op">==</span> <span class="dv">0</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>).select([<span class="st">"ChEMBL ID"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Type"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Max Phase"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"QED Weighted"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogP"</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogD"</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>df_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (612795, 8)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL539070"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.63
</td>
<td>
2.57
</td>
<td>
2.57
</td>
<td>
17
</td>
</tr>
<tr>
<td>
"CHEMBL3827271"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.07
</td>
<td>
-6.88
</td>
<td>
-8.95
</td>
<td>
50
</td>
</tr>
<tr>
<td>
"CHEMBL3824158"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.31
</td>
<td>
2.49
</td>
<td>
2.42
</td>
<td>
31
</td>
</tr>
<tr>
<td>
"CHEMBL1991010"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.6
</td>
<td>
6.34
</td>
<td>
5.22
</td>
<td>
31
</td>
</tr>
<tr>
<td>
"CHEMBL195644"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.73
</td>
<td>
3.92
</td>
<td>
3.91
</td>
<td>
28
</td>
</tr>
<tr>
<td>
"CHEMBL255263"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.72
</td>
<td>
1.74
</td>
<td>
1.74
</td>
<td>
27
</td>
</tr>
<tr>
<td>
"CHEMBL504846"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
3
</td>
<td>
0.23
</td>
<td>
3.4
</td>
<td>
2.87
</td>
<td>
58
</td>
</tr>
<tr>
<td>
"CHEMBL85010"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.22
</td>
<td>
3.27
</td>
<td>
2.75
</td>
<td>
35
</td>
</tr>
<tr>
<td>
"CHEMBL1364151"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
2.38
</td>
<td>
2.14
</td>
<td>
23
</td>
</tr>
<tr>
<td>
"CHEMBL2047203"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.06
</td>
<td>
4.35
</td>
<td>
4.11
</td>
<td>
61
</td>
</tr>
<tr>
<td>
"CHEMBL3798157"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.4
</td>
<td>
3.97
</td>
<td>
3.64
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL1337107"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.75
</td>
<td>
2.35
</td>
<td>
2.35
</td>
<td>
22
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL255122"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.47
</td>
<td>
1.68
</td>
<td>
1.65
</td>
<td>
36
</td>
</tr>
<tr>
<td>
"CHEMBL2018776"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.26
</td>
<td>
5.66
</td>
<td>
3.88
</td>
<td>
36
</td>
</tr>
<tr>
<td>
"CHEMBL97207"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.89
</td>
<td>
2.1
</td>
<td>
2.1
</td>
<td>
18
</td>
</tr>
<tr>
<td>
"CHEMBL221343"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.55
</td>
<td>
5.46
</td>
<td>
5.46
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"CHEMBL1420018"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.52
</td>
<td>
2.38
</td>
<td>
2.38
</td>
<td>
19
</td>
</tr>
<tr>
<td>
"CHEMBL2314244"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.2
</td>
<td>
-0.72
</td>
<td>
-3.93
</td>
<td>
34
</td>
</tr>
<tr>
<td>
"CHEMBL1420130"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.63
</td>
<td>
2.94
</td>
<td>
2.94
</td>
<td>
15
</td>
</tr>
<tr>
<td>
"CHEMBL2419480"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.59
</td>
<td>
2.14
</td>
<td>
1.2
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL540121"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.22
</td>
<td>
-0.75
</td>
<td>
-0.78
</td>
<td>
36
</td>
</tr>
<tr>
<td>
"CHEMBL374041"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.28
</td>
<td>
2.17
</td>
<td>
1.33
</td>
<td>
37
</td>
</tr>
<tr>
<td>
"CHEMBL2017916"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.8
</td>
<td>
2.17
</td>
<td>
2.1
</td>
<td>
22
</td>
</tr>
<tr>
<td>
"CHEMBL1416264"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.54
</td>
<td>
2.47
</td>
<td>
2.47
</td>
<td>
27
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_4 <span class="op">=</span> df_dn.<span class="bu">filter</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Type"</span>) <span class="op">==</span> <span class="st">"Small molecule"</span>) <span class="op">&amp;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Max Phase"</span>) <span class="op">==</span> <span class="dv">4</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>).select([<span class="st">"ChEMBL ID"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Type"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Max Phase"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"QED Weighted"</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogP"</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogD"</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>df_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (944, 8)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1096882"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.31
</td>
<td>
-1.97
</td>
<td>
-5.12
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"CHEMBL2023898"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.14
</td>
<td>
4.18
</td>
<td>
4.16
</td>
<td>
54
</td>
</tr>
<tr>
<td>
"CHEMBL1029"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
-1.18
</td>
<td>
-2.3
</td>
<td>
15
</td>
</tr>
<tr>
<td>
"CHEMBL1616"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.72
</td>
<td>
2.88
</td>
<td>
2.58
</td>
<td>
20
</td>
</tr>
<tr>
<td>
"CHEMBL2146123"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.33
</td>
<td>
-3.51
</td>
<td>
-3.81
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL1200773"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.75
</td>
<td>
1.88
</td>
<td>
1.0
</td>
<td>
14
</td>
</tr>
<tr>
<td>
"CHEMBL1201002"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
1.42
</td>
<td>
-0.89
</td>
<td>
21
</td>
</tr>
<tr>
<td>
"CHEMBL1086440"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
5.88
</td>
<td>
5.88
</td>
<td>
21
</td>
</tr>
<tr>
<td>
"CHEMBL2359966"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
2.51
</td>
<td>
0.86
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"CHEMBL302795"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.87
</td>
<td>
-0.12
</td>
<td>
-1.91
</td>
<td>
22
</td>
</tr>
<tr>
<td>
"CHEMBL1214185"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.08
</td>
<td>
3.0
</td>
<td>
1.32
</td>
<td>
58
</td>
</tr>
<tr>
<td>
"CHEMBL487253"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.7
</td>
<td>
1.8
</td>
<td>
0.81
</td>
<td>
23
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL2103743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.93
</td>
<td>
1.24
</td>
<td>
1.19
</td>
<td>
23
</td>
</tr>
<tr>
<td>
"CHEMBL3989931"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
4.59
</td>
<td>
4.59
</td>
<td>
33
</td>
</tr>
<tr>
<td>
"CHEMBL1201033"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.32
</td>
<td>
3.4
</td>
<td>
1.0
</td>
<td>
19
</td>
</tr>
<tr>
<td>
"CHEMBL1201731"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.69
</td>
<td>
3.21
</td>
<td>
1.71
</td>
<td>
29
</td>
</tr>
<tr>
<td>
"CHEMBL2105743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
1.19
</td>
<td>
-0.18
</td>
<td>
28
</td>
</tr>
<tr>
<td>
"CHEMBL4297513"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.26
</td>
<td>
4.9
</td>
<td>
4.9
</td>
<td>
53
</td>
</tr>
<tr>
<td>
"CHEMBL1201321"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
2.65
</td>
<td>
2.65
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL3545062"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.1
</td>
<td>
5.57
</td>
<td>
5.57
</td>
<td>
65
</td>
</tr>
<tr>
<td>
"CHEMBL3039520"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.83
</td>
<td>
3.3
</td>
<td>
2.61
</td>
<td>
27
</td>
</tr>
<tr>
<td>
"CHEMBL1198857"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.26
</td>
<td>
3.6
</td>
<td>
1.93
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL2146133"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
2.43
</td>
<td>
2.43
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"CHEMBL1619785"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.49
</td>
<td>
2.09
</td>
<td>
1.86
</td>
<td>
34
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="re-sampling-via-under-sampling" class="level5">
<h5 class="anchored" data-anchor-id="re-sampling-via-under-sampling"><strong>Re-sampling via under-sampling</strong></h5>
<p>Because of the large number of Max Phase 0 compounds, I’ve sampled about 950 from this group, so that there were similar amount of data in each group.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_s_0 <span class="op">=</span> df_0.sample(n <span class="op">=</span> <span class="dv">950</span>, shuffle <span class="op">=</span> <span class="va">True</span>, seed <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_s_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (950, 8)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL3448290"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.91
</td>
<td>
2.05
</td>
<td>
0.62
</td>
<td>
21
</td>
</tr>
<tr>
<td>
"CHEMBL3966308"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.16
</td>
<td>
1.51
</td>
<td>
-0.41
</td>
<td>
48
</td>
</tr>
<tr>
<td>
"CHEMBL3963545"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.2
</td>
<td>
5.05
</td>
<td>
3.27
</td>
<td>
46
</td>
</tr>
<tr>
<td>
"CHEMBL1649629"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.53
</td>
<td>
3.21
</td>
<td>
3.21
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"CHEMBL3813954"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.14
</td>
<td>
2.8
</td>
<td>
2.8
</td>
<td>
37
</td>
</tr>
<tr>
<td>
"CHEMBL1164717"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.42
</td>
<td>
1.6
</td>
<td>
1.55
</td>
<td>
35
</td>
</tr>
<tr>
<td>
"CHEMBL1824896"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
4.69
</td>
<td>
4.13
</td>
<td>
34
</td>
</tr>
<tr>
<td>
"CHEMBL2323807"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
3.09
</td>
<td>
2.22
</td>
<td>
20
</td>
</tr>
<tr>
<td>
"CHEMBL3919258"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.5
</td>
<td>
1.36
</td>
<td>
1.36
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL1973768"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.61
</td>
<td>
-1.09
</td>
<td>
-1.09
</td>
<td>
15
</td>
</tr>
<tr>
<td>
"CHEMBL3193130"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.32
</td>
<td>
2.88
</td>
<td>
2.88
</td>
<td>
30
</td>
</tr>
<tr>
<td>
"CHEMBL157009"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.4
</td>
<td>
-1.57
</td>
<td>
-1.6
</td>
<td>
20
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL1586774"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.79
</td>
<td>
4.03
</td>
<td>
4.02
</td>
<td>
25
</td>
</tr>
<tr>
<td>
"CHEMBL3735848"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.62
</td>
<td>
2.49
</td>
<td>
2.48
</td>
<td>
31
</td>
</tr>
<tr>
<td>
"CHEMBL2238035"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.63
</td>
<td>
-0.89
</td>
<td>
-0.9
</td>
<td>
18
</td>
</tr>
<tr>
<td>
"CHEMBL2409594"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.42
</td>
<td>
2.9
</td>
<td>
2.9
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL1823603"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.51
</td>
<td>
4.06
</td>
<td>
4.06
</td>
<td>
32
</td>
</tr>
<tr>
<td>
"CHEMBL1373723"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.25
</td>
<td>
4.85
</td>
<td>
4.84
</td>
<td>
47
</td>
</tr>
<tr>
<td>
"CHEMBL1092638"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.45
</td>
<td>
5.0
</td>
<td>
4.78
</td>
<td>
34
</td>
</tr>
<tr>
<td>
"CHEMBL3884327"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.23
</td>
<td>
2.0
</td>
<td>
1.31
</td>
<td>
33
</td>
</tr>
<tr>
<td>
"CHEMBL3952298"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.27
</td>
<td>
4.75
</td>
<td>
4.75
</td>
<td>
37
</td>
</tr>
<tr>
<td>
"CHEMBL3958658"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.37
</td>
<td>
4.32
</td>
<td>
4.32
</td>
<td>
36
</td>
</tr>
<tr>
<td>
"CHEMBL2181572"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.32
</td>
<td>
3.3
</td>
<td>
3.3
</td>
<td>
23
</td>
</tr>
<tr>
<td>
"CHEMBL603992"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.27
</td>
<td>
3.51
</td>
<td>
3.51
</td>
<td>
35
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plan is to use logistic regression method for ML model, so the y variable I'm interested in</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here is whether a small molecule will be approved or not so it's going to be a binary </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># categorical variable - means it needs to be 0 (not approved) or 1 (approved)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># To do this, add a new column with a new name of "Max_Phase" &amp; replace "4" as "1" (by dividing</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by 4 to reach this new label)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>df_4_f <span class="op">=</span> df_4.with_columns((pl.col(<span class="st">"Max Phase"</span>) <span class="op">/</span> <span class="dv">4</span>).alias(<span class="st">"Max_Phase"</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df_4_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (944, 9)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
<th>
Max_Phase
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1096882"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.31
</td>
<td>
-1.97
</td>
<td>
-5.12
</td>
<td>
24
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL2023898"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.14
</td>
<td>
4.18
</td>
<td>
4.16
</td>
<td>
54
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1029"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
-1.18
</td>
<td>
-2.3
</td>
<td>
15
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1616"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.72
</td>
<td>
2.88
</td>
<td>
2.58
</td>
<td>
20
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL2146123"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.33
</td>
<td>
-3.51
</td>
<td>
-3.81
</td>
<td>
32
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1200773"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.75
</td>
<td>
1.88
</td>
<td>
1.0
</td>
<td>
14
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1201002"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
1.42
</td>
<td>
-0.89
</td>
<td>
21
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1086440"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
5.88
</td>
<td>
5.88
</td>
<td>
21
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL2359966"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
2.51
</td>
<td>
0.86
</td>
<td>
24
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL302795"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.87
</td>
<td>
-0.12
</td>
<td>
-1.91
</td>
<td>
22
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1214185"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.08
</td>
<td>
3.0
</td>
<td>
1.32
</td>
<td>
58
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL487253"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.7
</td>
<td>
1.8
</td>
<td>
0.81
</td>
<td>
23
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL2103743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.93
</td>
<td>
1.24
</td>
<td>
1.19
</td>
<td>
23
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL3989931"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
4.59
</td>
<td>
4.59
</td>
<td>
33
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1201033"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.32
</td>
<td>
3.4
</td>
<td>
1.0
</td>
<td>
19
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1201731"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.69
</td>
<td>
3.21
</td>
<td>
1.71
</td>
<td>
29
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL2105743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
1.19
</td>
<td>
-0.18
</td>
<td>
28
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL4297513"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.26
</td>
<td>
4.9
</td>
<td>
4.9
</td>
<td>
53
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1201321"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
2.65
</td>
<td>
2.65
</td>
<td>
32
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL3545062"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.1
</td>
<td>
5.57
</td>
<td>
5.57
</td>
<td>
65
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL3039520"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.83
</td>
<td>
3.3
</td>
<td>
2.61
</td>
<td>
27
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1198857"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.26
</td>
<td>
3.6
</td>
<td>
1.93
</td>
<td>
32
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL2146133"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
2.43
</td>
<td>
2.43
</td>
<td>
24
</td>
<td>
1.0
</td>
</tr>
<tr>
<td>
"CHEMBL1619785"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.49
</td>
<td>
2.09
</td>
<td>
1.86
</td>
<td>
34
</td>
<td>
1.0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of "Max_Phase" from float to integer</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># So that the two different dataframes can be concatenated</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_4_f <span class="op">=</span> df_4_f.with_column((pl.col(<span class="st">"Max_Phase"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>df_4_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (944, 9)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
<th>
Max_Phase
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL1096882"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.31
</td>
<td>
-1.97
</td>
<td>
-5.12
</td>
<td>
24
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL2023898"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.14
</td>
<td>
4.18
</td>
<td>
4.16
</td>
<td>
54
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1029"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
-1.18
</td>
<td>
-2.3
</td>
<td>
15
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1616"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.72
</td>
<td>
2.88
</td>
<td>
2.58
</td>
<td>
20
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL2146123"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.33
</td>
<td>
-3.51
</td>
<td>
-3.81
</td>
<td>
32
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1200773"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.75
</td>
<td>
1.88
</td>
<td>
1.0
</td>
<td>
14
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1201002"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
1.42
</td>
<td>
-0.89
</td>
<td>
21
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1086440"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
5.88
</td>
<td>
5.88
</td>
<td>
21
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL2359966"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
2.51
</td>
<td>
0.86
</td>
<td>
24
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL302795"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.87
</td>
<td>
-0.12
</td>
<td>
-1.91
</td>
<td>
22
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1214185"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.08
</td>
<td>
3.0
</td>
<td>
1.32
</td>
<td>
58
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL487253"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.7
</td>
<td>
1.8
</td>
<td>
0.81
</td>
<td>
23
</td>
<td>
1
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL2103743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.93
</td>
<td>
1.24
</td>
<td>
1.19
</td>
<td>
23
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL3989931"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
4.59
</td>
<td>
4.59
</td>
<td>
33
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1201033"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.32
</td>
<td>
3.4
</td>
<td>
1.0
</td>
<td>
19
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1201731"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.69
</td>
<td>
3.21
</td>
<td>
1.71
</td>
<td>
29
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL2105743"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
1.19
</td>
<td>
-0.18
</td>
<td>
28
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL4297513"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.26
</td>
<td>
4.9
</td>
<td>
4.9
</td>
<td>
53
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1201321"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
2.65
</td>
<td>
2.65
</td>
<td>
32
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL3545062"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
2
</td>
<td>
0.1
</td>
<td>
5.57
</td>
<td>
5.57
</td>
<td>
65
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL3039520"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.83
</td>
<td>
3.3
</td>
<td>
2.61
</td>
<td>
27
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1198857"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.26
</td>
<td>
3.6
</td>
<td>
1.93
</td>
<td>
32
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL2146133"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
2.43
</td>
<td>
2.43
</td>
<td>
24
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"CHEMBL1619785"
</td>
<td>
"Small molecule...
</td>
<td>
4
</td>
<td>
0
</td>
<td>
0.49
</td>
<td>
2.09
</td>
<td>
1.86
</td>
<td>
34
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also create a new column with the same name of "Max_Phase"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># So that the dataframes can be combined</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df_s_0_f <span class="op">=</span> df_s_0.with_column((pl.col(<span class="st">"Max Phase"</span>)).alias(<span class="st">"Max_Phase"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df_s_0_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (950, 9)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
ChEMBL ID
</th>
<th>
Type
</th>
<th>
Max Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
<th>
Max_Phase
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"CHEMBL3448290"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.91
</td>
<td>
2.05
</td>
<td>
0.62
</td>
<td>
21
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3966308"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.16
</td>
<td>
1.51
</td>
<td>
-0.41
</td>
<td>
48
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3963545"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.2
</td>
<td>
5.05
</td>
<td>
3.27
</td>
<td>
46
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1649629"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.53
</td>
<td>
3.21
</td>
<td>
3.21
</td>
<td>
24
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3813954"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.14
</td>
<td>
2.8
</td>
<td>
2.8
</td>
<td>
37
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1164717"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.42
</td>
<td>
1.6
</td>
<td>
1.55
</td>
<td>
35
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1824896"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
4.69
</td>
<td>
4.13
</td>
<td>
34
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL2323807"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
3.09
</td>
<td>
2.22
</td>
<td>
20
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3919258"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.5
</td>
<td>
1.36
</td>
<td>
1.36
</td>
<td>
32
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1973768"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.61
</td>
<td>
-1.09
</td>
<td>
-1.09
</td>
<td>
15
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3193130"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.32
</td>
<td>
2.88
</td>
<td>
2.88
</td>
<td>
30
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL157009"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.4
</td>
<td>
-1.57
</td>
<td>
-1.6
</td>
<td>
20
</td>
<td>
0
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
"CHEMBL1586774"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.79
</td>
<td>
4.03
</td>
<td>
4.02
</td>
<td>
25
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3735848"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.62
</td>
<td>
2.49
</td>
<td>
2.48
</td>
<td>
31
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL2238035"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.63
</td>
<td>
-0.89
</td>
<td>
-0.9
</td>
<td>
18
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL2409594"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.42
</td>
<td>
2.9
</td>
<td>
2.9
</td>
<td>
32
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1823603"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.51
</td>
<td>
4.06
</td>
<td>
4.06
</td>
<td>
32
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1373723"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.25
</td>
<td>
4.85
</td>
<td>
4.84
</td>
<td>
47
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL1092638"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.45
</td>
<td>
5.0
</td>
<td>
4.78
</td>
<td>
34
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3884327"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.23
</td>
<td>
2.0
</td>
<td>
1.31
</td>
<td>
33
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3952298"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0.27
</td>
<td>
4.75
</td>
<td>
4.75
</td>
<td>
37
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL3958658"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.37
</td>
<td>
4.32
</td>
<td>
4.32
</td>
<td>
36
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL2181572"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.32
</td>
<td>
3.3
</td>
<td>
3.3
</td>
<td>
23
</td>
<td>
0
</td>
</tr>
<tr>
<td>
"CHEMBL603992"
</td>
<td>
"Small molecule...
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.27
</td>
<td>
3.51
</td>
<td>
3.51
</td>
<td>
35
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine df_s_0_f (dataframe with max phase 0 compounds) &amp; df_4_f (df with max phase 4 compounds)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_concat <span class="op">=</span> pl.concat([df_s_0_f, df_4_f], how <span class="op">=</span> <span class="st">"vertical"</span>,)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_concat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1894, 9)
┌───────────┬───────────┬───────────┬────────────┬─────┬─────────┬─────────┬───────────┬───────────┐
│ ChEMBL ID ┆ Type      ┆ Max Phase ┆ #RO5       ┆ ... ┆ CX LogP ┆ CX LogD ┆ Heavy     ┆ Max_Phase │
│ ---       ┆ ---       ┆ ---       ┆ Violations ┆     ┆ ---     ┆ ---     ┆ Atoms     ┆ ---       │
│ str       ┆ str       ┆ i64       ┆ ---        ┆     ┆ f64     ┆ f64     ┆ ---       ┆ i64       │
│           ┆           ┆           ┆ i64        ┆     ┆         ┆         ┆ i64       ┆           │
╞═══════════╪═══════════╪═══════════╪════════════╪═════╪═════════╪═════════╪═══════════╪═══════════╡
│ CHEMBL344 ┆ Small     ┆ 0         ┆ 0          ┆ ... ┆ 2.05    ┆ 0.62    ┆ 21        ┆ 0         │
│ 8290      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL396 ┆ Small     ┆ 0         ┆ 2          ┆ ... ┆ 1.51    ┆ -0.41   ┆ 48        ┆ 0         │
│ 6308      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL396 ┆ Small     ┆ 0         ┆ 2          ┆ ... ┆ 5.05    ┆ 3.27    ┆ 46        ┆ 0         │
│ 3545      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL164 ┆ Small     ┆ 0         ┆ 0          ┆ ... ┆ 3.21    ┆ 3.21    ┆ 24        ┆ 0         │
│ 9629      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ ...       ┆ ...       ┆ ...       ┆ ...        ┆ ... ┆ ...     ┆ ...     ┆ ...       ┆ ...       │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL303 ┆ Small     ┆ 4         ┆ 0          ┆ ... ┆ 3.3     ┆ 2.61    ┆ 27        ┆ 1         │
│ 9520      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL119 ┆ Small     ┆ 4         ┆ 0          ┆ ... ┆ 3.6     ┆ 1.93    ┆ 32        ┆ 1         │
│ 8857      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL214 ┆ Small     ┆ 4         ┆ 0          ┆ ... ┆ 2.43    ┆ 2.43    ┆ 24        ┆ 1         │
│ 6133      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
├╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌┤
│ CHEMBL161 ┆ Small     ┆ 4         ┆ 0          ┆ ... ┆ 2.09    ┆ 1.86    ┆ 34        ┆ 1         │
│ 9785      ┆ molecule  ┆           ┆            ┆     ┆         ┆         ┆           ┆           │
└───────────┴───────────┴───────────┴────────────┴─────┴─────────┴─────────┴───────────┴───────────┘</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check this df_concat dataset has all compounds in Max Phase 0 &amp; 4 only</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note Max Phase 4 (approved) compounds were re-labelled as Max_Phase = 1 </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df_concat.groupby(<span class="st">"Max_Phase"</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Max_Phase
</th>
<th>
count
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
950
</td>
</tr>
<tr>
<td>
1
</td>
<td>
944
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check df_concat dataset only has small molecules</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df_concat.groupby(<span class="st">"Type"</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Type
</th>
<th>
count
</th>
</tr>
<tr>
<td>
str
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"Small molecule...
</td>
<td>
1894
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final version of dataset before entering ML phase </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave out ChEMBL ID and Type</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_ml <span class="op">=</span> df_concat.select([<span class="st">"Max_Phase"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"QED Weighted"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"CX LogP"</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"CX LogD"</span>, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>df_ml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1894, 6)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Max_Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
f64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.91
</td>
<td>
2.05
</td>
<td>
0.62
</td>
<td>
21
</td>
</tr>
<tr>
<td>
0
</td>
<td>
2
</td>
<td>
0.16
</td>
<td>
1.51
</td>
<td>
-0.41
</td>
<td>
48
</td>
</tr>
<tr>
<td>
0
</td>
<td>
2
</td>
<td>
0.2
</td>
<td>
5.05
</td>
<td>
3.27
</td>
<td>
46
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.53
</td>
<td>
3.21
</td>
<td>
3.21
</td>
<td>
24
</td>
</tr>
<tr>
<td>
0
</td>
<td>
1
</td>
<td>
0.14
</td>
<td>
2.8
</td>
<td>
2.8
</td>
<td>
37
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.42
</td>
<td>
1.6
</td>
<td>
1.55
</td>
<td>
35
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
4.69
</td>
<td>
4.13
</td>
<td>
34
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.88
</td>
<td>
3.09
</td>
<td>
2.22
</td>
<td>
20
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.5
</td>
<td>
1.36
</td>
<td>
1.36
</td>
<td>
32
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.61
</td>
<td>
-1.09
</td>
<td>
-1.09
</td>
<td>
15
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.32
</td>
<td>
2.88
</td>
<td>
2.88
</td>
<td>
30
</td>
</tr>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0.4
</td>
<td>
-1.57
</td>
<td>
-1.6
</td>
<td>
20
</td>
</tr>
<tr>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.93
</td>
<td>
1.24
</td>
<td>
1.19
</td>
<td>
23
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.46
</td>
<td>
4.59
</td>
<td>
4.59
</td>
<td>
33
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
0.32
</td>
<td>
3.4
</td>
<td>
1.0
</td>
<td>
19
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.69
</td>
<td>
3.21
</td>
<td>
1.71
</td>
<td>
29
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.58
</td>
<td>
1.19
</td>
<td>
-0.18
</td>
<td>
28
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
0.26
</td>
<td>
4.9
</td>
<td>
4.9
</td>
<td>
53
</td>
</tr>
<tr>
<td>
1
</td>
<td>
1
</td>
<td>
0.58
</td>
<td>
2.65
</td>
<td>
2.65
</td>
<td>
32
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
0.1
</td>
<td>
5.57
</td>
<td>
5.57
</td>
<td>
65
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.83
</td>
<td>
3.3
</td>
<td>
2.61
</td>
<td>
27
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.26
</td>
<td>
3.6
</td>
<td>
1.93
</td>
<td>
32
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.77
</td>
<td>
2.43
</td>
<td>
2.43
</td>
<td>
24
</td>
</tr>
<tr>
<td>
1
</td>
<td>
0
</td>
<td>
0.49
</td>
<td>
2.09
</td>
<td>
1.86
</td>
<td>
34
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_ml.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (1, 6)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Max_Phase
</th>
<th>
#RO5 Violations
</th>
<th>
QED Weighted
</th>
<th>
CX LogP
</th>
<th>
CX LogD
</th>
<th>
Heavy Atoms
</th>
</tr>
<tr>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data types in df_ml dataset</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Needs to be integers or floats for scikit-learn algorithms to work</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df_ml.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>[polars.datatypes.Int64,
 polars.datatypes.Int64,
 polars.datatypes.Float64,
 polars.datatypes.Float64,
 polars.datatypes.Float64,
 polars.datatypes.Int64]</code></pre>
</div>
</div>
</section>
</section>
<section id="import-libraries-for-ml" class="level4">
<h4 class="anchored" data-anchor-id="import-libraries-for-ml"><strong>Import libraries for ML</strong></h4>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install scikit-learn - an open-source ML library</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the line below if needing to install this library</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install -U scikit-learn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import scikit-learn</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check scikit-learn version</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sklearn.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.2.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import other libraries needed to generate ML model (in this case - logistic regression)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To use NumPy arrays to prepare X &amp; y variables</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Needed for dataframe to be used in scikit-learn ML</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To normalise dataset prior to running ML</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># To split dataset into training &amp; testing sets</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># To show data viz/graphs in Jupyter notebook</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">#%matplotlib inline</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Import matplotlib/pyplot for data viz</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install matplotlib</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: pandas in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (1.5.2)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from pandas) (2022.7)
Requirement already satisfied: numpy&gt;=1.21.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from pandas) (1.23.5)
Requirement already satisfied: six&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from python-dateutil&gt;=2.8.1-&gt;pandas) (1.16.0)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: matplotlib in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (3.6.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (1.0.6)
Requirement already satisfied: cycler&gt;=0.10 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (0.11.0)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: fonttools&gt;=4.22.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (4.38.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (1.4.4)
Requirement already satisfied: numpy&gt;=1.19 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (1.23.5)
Requirement already satisfied: packaging&gt;=20.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (21.3)
Requirement already satisfied: pillow&gt;=6.2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (9.3.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib) (2.8.2)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: six&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install pyarrow to convert Polars dataframe into Pandas dataframe (needed to run scikit-Learn)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pyarrow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: pyarrow in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (10.0.1)
Requirement already satisfied: numpy&gt;=1.16.6 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from pyarrow) (1.23.5)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Polars df to Pandas df so that scikit-learn can be used for ML</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>df_ml_pd <span class="op">=</span> df_ml.to_pandas()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df_ml_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
</section>
<section id="logistic-regression-with-scikit-learn" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression-with-scikit-learn"><strong>Logistic regression with <em>scikit-learn</em></strong></h4>
<p>Logistic regression was one of the supervised learning strategies in the machine learning realm. As the term “supervised” suggested, this type of ML was purely data-driven to allow computers to learn patterns from input data with the aim of reaching a predictive model in the end to help answer our questions.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define X variables from df_ml_pd dataset</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.asarray(df_ml_pd[[<span class="st">"#RO5 Violations"</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"QED Weighted"</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"CX LogP"</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"CX LogD"</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Heavy Atoms"</span>]]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[ 0.  ,  0.91,  2.05,  0.62, 21.  ],
       [ 2.  ,  0.16,  1.51, -0.41, 48.  ],
       [ 2.  ,  0.2 ,  5.05,  3.27, 46.  ],
       [ 0.  ,  0.53,  3.21,  3.21, 24.  ],
       [ 1.  ,  0.14,  2.8 ,  2.8 , 37.  ]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define y variable - note to use "Max_Phase", not the original "Max Phase"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.asarray(df_ml_pd[<span class="st">"Max_Phase"</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([0, 0, 0, 0, 0])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split dataset into trainging &amp; testing sets</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">0</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state <span class="op">=</span> rng)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training set:'</span>, X_train.shape, y_train.shape)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Testing set:'</span>, X_test.shape, y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set: (1515, 5) (1515,)
Testing set: (379, 5) (379,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise &amp; clean the dataset</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit on the training set (not on testing set as this may lead to data leakage)</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform on the testing set</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> preprocessing.StandardScaler().fit(X_train).transform(X_test)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[-0.61683613,  0.76594864,  0.29675851,  0.52596937, -0.79684902],
       [ 0.61602236,  0.45724627,  1.96615599,  1.92002856, -0.11325544],
       [ 1.84888085, -1.43906824, -2.1393532 , -3.75082759,  0.37502569],
       [ 0.61602236, -0.73346284, -2.1166917 , -1.56196543,  0.27736946],
       [-0.61683613, -0.07195778, -1.5954771 , -1.05417464, -0.99216147]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import logistic regression </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an instance of logistic regression classifier and fit the data</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>LogR <span class="op">=</span> LogisticRegression().fit(X_train, y_train)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>LogR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>y_mp <span class="op">=</span> LogR.predict(X_test)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>y_mp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0,
       0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1,
       0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1,
       0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1,
       1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
       0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1,
       1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0,
       1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1,
       0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1,
       1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0,
       0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0,
       0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
       0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0,
       0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1,
       0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0,
       0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1,
       0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,
       0, 0, 0, 0, 1])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the predicted values (in terms of log odds) into a dataframe</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Then use describe() method to get characteristics of the distribution</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> pd.DataFrame(LogR.predict_log_proba(X))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>pred.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>379.000000</td>
      <td>379.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.834407</td>
      <td>-0.674677</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.383863</td>
      <td>0.332967</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.818149</td>
      <td>-2.239351</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.058584</td>
      <td>-0.887024</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.779455</td>
      <td>-0.613700</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-0.530824</td>
      <td>-0.426098</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-0.112640</td>
      <td>-0.177126</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or a quicker way to get the predicted probabilities is via predict_proba() method</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>y_mp_proba <span class="op">=</span> LogR.predict_proba(X_test)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment below to see the predicted probabilities printed</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(y_mp_proba)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predicted probabilities into a dataframe</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># then use describe() to show distributions</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>y_mp_prob <span class="op">=</span> pd.DataFrame(y_mp_proba)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>y_mp_prob.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>379.000000</td>
      <td>379.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.496784</td>
      <td>0.503216</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.174218</td>
      <td>0.174218</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.004315</td>
      <td>0.143818</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.382057</td>
      <td>0.375627</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.517089</td>
      <td>0.482911</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.624373</td>
      <td>0.617943</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.856182</td>
      <td>0.995685</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: for imbalanced dataset, accuracy score may not be very informative, use other metrics</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to evaluate or use other strategies to compensate for it</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_mp, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>0.7018469656992085</code></pre>
</div>
</div>
<section id="pipeline-method-for-logistic-regression" class="level5">
<h5 class="anchored" data-anchor-id="pipeline-method-for-logistic-regression"><strong>Pipeline method for logistic regression</strong></h5>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test pipline from scikit-Learn</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>LR <span class="op">=</span> make_pipeline(StandardScaler(), LogisticRegression())</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>LR.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('standardscaler', StandardScaler()),
                ('logisticregression', LogisticRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('standardscaler', StandardScaler()),
                ('logisticregression', LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>LR.score(X_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0.6965699208443272</code></pre>
</div>
</div>
</section>
</section>
<section id="evaluation-of-the-logistic-regression-model" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-of-the-logistic-regression-model"><strong>Evaluation of the logistic regression model</strong></h4>
<section id="jaccard-score" class="level5">
<h5 class="anchored" data-anchor-id="jaccard-score"><strong>Jaccard score</strong></h5>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> jaccard_score</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>jaccard_score(y_test, y_mp, pos_label <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>0.549800796812749</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix" class="level5">
<h5 class="anchored" data-anchor-id="confusion-matrix"><strong>Confusion matrix</strong></h5>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import classification report &amp; confusion matrix from scikit-learn library</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import itertools - functions to create iterators for efficient looping</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot confusion matrix</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># cm = confusion matrix</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># classes = 0 or 1 (no success/max phase 0-3 or success/max phase 4)</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_confusion_matrix(<span class="co"># Sets a cm object</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                          cm, </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># Sets classes of '1s' (Successes) &amp; '0s' (Non-successes) for the cm</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                          classes,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># If setting normalize = true, reports in ratios instead of counts</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                          normalize,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                          title <span class="op">=</span> <span class="st">'Confusion matrix'</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># Choose colour of the cm (colourmap recognised by matplotlib)</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>                          cmap <span class="op">=</span> plt.cm.Reds):</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co">    This function prints and plots the confusion matrix.</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Normalization can be applied by setting `normalize = True`.</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalize:</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> cm.astype(<span class="st">'float'</span>) <span class="op">/</span> cm.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)[:, np.newaxis]</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Normalized confusion matrix"</span>)</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Confusion matrix, without normalization'</span>)</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cm)</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the confusion matrix </span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    plt.imshow(cm, interpolation <span class="op">=</span> <span class="st">'nearest'</span>, cmap <span class="op">=</span> cmap)</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>    plt.colorbar()</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>    tick_marks <span class="op">=</span> np.arange(<span class="bu">len</span>(classes))</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>    plt.xticks(tick_marks, classes, rotation <span class="op">=</span> <span class="dv">45</span>)</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>    plt.yticks(tick_marks, classes)</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sets the decimal places of ratios if using normalize = True</span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>    fmt <span class="op">=</span> <span class="st">'.2f'</span> <span class="cf">if</span> normalize <span class="cf">else</span> <span class="st">'d'</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sets threshold for normalised results (ratios)</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cm.<span class="bu">max</span>() <span class="op">/</span> <span class="fl">2.</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate through the ratios and differentiate between the text colours </span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># by using the threshold cut-off</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, j <span class="kw">in</span> itertools.product(<span class="bu">range</span>(cm.shape[<span class="dv">0</span>]), <span class="bu">range</span>(cm.shape[<span class="dv">1</span>])):</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>        plt.text(j, i, <span class="bu">format</span>(cm[i, j], fmt),</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment <span class="op">=</span> <span class="st">"center"</span>,</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> <span class="st">"white"</span> <span class="cf">if</span> cm[i, j] <span class="op">&gt;</span> thresh <span class="cf">else</span> <span class="st">"black"</span>)</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'True label'</span>)</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Predicted label'</span>)</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_mp, labels <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[128  62]
 [ 51 138]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confusion matrix</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> confusion_matrix(y_test, y_mp, labels <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix without normalisation</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(matrix, </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                      classes <span class="op">=</span> [<span class="st">'Max_Phase = 0'</span>,<span class="st">'Max_Phase = 1'</span>], </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                      normalize <span class="op">=</span> <span class="va">False</span>, </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                      title <span class="op">=</span> <span class="st">"Confusion matrix without normalisation"</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion matrix, without normalization
[[128  62]
 [ 51 138]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Rust_pl_chembl_cpds_files/figure-html/cell-47-output-2.png" width="570" height="488"></p>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_mp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.69      0.73      0.71       189
           1       0.72      0.67      0.69       190

    accuracy                           0.70       379
   macro avg       0.70      0.70      0.70       379
weighted avg       0.70      0.70      0.70       379
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log loss</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The further the predicted probability is from the actual/true value, the larger the log loss</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ideally, the smaller the log loss the better the model will be</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gauge how good the log regression model is at figuring out whether the parameters</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># used are good to predict if a small molecule will be approved or not</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> log_loss</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>log_loss(y_test, y_mp_proba)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0.6149705820831467</code></pre>
</div>
</div>
<p><strong>Distributions of features in the df_dn dataset</strong></p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the types of compounds in the database</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>df_dn.groupby(<span class="st">"Type"</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (6, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Type
</th>
<th>
count
</th>
</tr>
<tr>
<td>
str
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"Unknown"
</td>
<td>
24
</td>
</tr>
<tr>
<td>
"Protein"
</td>
<td>
6756
</td>
</tr>
<tr>
<td>
"Small molecule...
</td>
<td>
614702
</td>
</tr>
<tr>
<td>
"Unclassified"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
"Oligosaccharid...
</td>
<td>
2
</td>
</tr>
<tr>
<td>
""
</td>
<td>
115084
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Viz - bar graphs for each category</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df_dn.groupby(<span class="st">"Molecular Species"</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (4, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Molecular Species
</th>
<th>
count
</th>
</tr>
<tr>
<td>
str
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"NEUTRAL"
</td>
<td>
490662
</td>
</tr>
<tr>
<td>
"BASE"
</td>
<td>
102735
</td>
</tr>
<tr>
<td>
"ZWITTERION"
</td>
<td>
37983
</td>
</tr>
<tr>
<td>
"ACID"
</td>
<td>
105190
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df_dn.groupby(<span class="st">"Structure Type"</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Structure Type
</th>
<th>
count
</th>
</tr>
<tr>
<td>
str
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"MOL"
</td>
<td>
729834
</td>
</tr>
<tr>
<td>
"BOTH"
</td>
<td>
6736
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df_dn.groupby(<span class="st">"Inorganic Flag"</span>, maintain_order <span class="op">=</span> <span class="va">True</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }

    .dataframe td {
        white-space: pre;
    }

    .dataframe td {
        padding-top: 0;
    }

    .dataframe td {
        padding-bottom: 0;
    }

    .dataframe td {
        line-height: 95%;
    }
</style>
<small>shape: (2, 2)</small><table class="dataframe table table-sm table-striped">

<thead>
<tr>
<th>
Inorganic Flag
</th>
<th>
count
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
u32
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
-1
</td>
<td>
684657
</td>
</tr>
<tr>
<td>
0
</td>
<td>
51913
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="jhylin/Data_in_life_blog" data-repo-id="R_kgDOHw7lGQ" data-category="General" data-category-id="DIC_kwDOHw7lGc4CQzQ_" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Blog made with ❤️ in <a href="https://quarto.org/">Quarto</a> by Jennifer HY Lin © 2022 📕 Citation as author and blog URL link if used</div>
  </div>
</footer>



</body></html>