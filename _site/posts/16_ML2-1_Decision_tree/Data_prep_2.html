<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer HY Lin">
<meta name="dcterms.date" content="2023-09-07">

<title>Home - Decision tree</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5CHVP3K63C"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5CHVP3K63C', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Jennifer HY Lin</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jhylin"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@jhylin"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jenhylin"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://jhylin.github.io/CV_resume_quarto/">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Decision tree</h1>
            <p class="subtitle lead">ML series 2.1 - data pre-processing (part 2)</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Machine learning projects</div>
                <div class="quarto-category">Pandas</div>
                <div class="quarto-category">ChEMBL database</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jennifer HY Lin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 7, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-source" id="toc-data-source" class="nav-link active" data-scroll-target="#data-source"><strong>Data source</strong></a></li>
  <li><a href="#re-import-saved-data" id="toc-re-import-saved-data" class="nav-link" data-scroll-target="#re-import-saved-data"><strong>Re-import saved data</strong></a></li>
  <li><a href="#calculate-pki" id="toc-calculate-pki" class="nav-link" data-scroll-target="#calculate-pki"><strong>Calculate pKi</strong></a></li>
  <li><a href="#plan-other-data-pre-processing-steps" id="toc-plan-other-data-pre-processing-steps" class="nav-link" data-scroll-target="#plan-other-data-pre-processing-steps"><strong>Plan other data pre-processing steps</strong></a></li>
  <li><a href="#check-data-validity" id="toc-check-data-validity" class="nav-link" data-scroll-target="#check-data-validity"><strong>Check data validity</strong></a></li>
  <li><a href="#sanitise-compounds" id="toc-sanitise-compounds" class="nav-link" data-scroll-target="#sanitise-compounds"><strong>Sanitise compounds</strong></a></li>
  <li><a href="#detect-outliers" id="toc-detect-outliers" class="nav-link" data-scroll-target="#detect-outliers"><strong>Detect outliers</strong></a></li>
  <li><a href="#calculate-molecular-descriptors" id="toc-calculate-molecular-descriptors" class="nav-link" data-scroll-target="#calculate-molecular-descriptors"><strong>Calculate molecular descriptors</strong></a>
  <ul>
  <li><a href="#rdkit-code" id="toc-rdkit-code" class="nav-link" data-scroll-target="#rdkit-code"><strong>RDKit code</strong></a></li>
  <li><a href="#datamol-code" id="toc-datamol-code" class="nav-link" data-scroll-target="#datamol-code"><strong>Datamol code</strong></a></li>
  <li><a href="#combine-dataframes" id="toc-combine-dataframes" class="nav-link" data-scroll-target="#combine-dataframes"><strong>Combine dataframes</strong></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jhylin/Data_in_life_blog/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="data-source" class="level5">
<h5 class="anchored" data-anchor-id="data-source"><strong>Data source</strong></h5>
<p>The data used in part 2 of data pre-processing was extracted from ChEMBL database by using ChEMBL webresource client in Python. The details of all the steps taken to reach the final .csv file could be seen in this earlier <em>post</em>. Since data preparation and cleaning was a well-known process that would take up a lot of time before doing anything significant on the data, I’ve splitted this process into two posts to ensure reasonable reading time for each.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import all libraries used</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datamol <span class="im">as</span> dm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tqdm library used in datamol's batch descriptor code</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="re-import-saved-data" class="level5">
<h5 class="anchored" data-anchor-id="re-import-saved-data"><strong>Re-import saved data</strong></h5>
<p>Re-imported the partly pre-processed data from the earlier post.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dtree_df <span class="op">=</span> pd.read_csv(<span class="st">"ache_chembl.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dtree_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>CHEMBL11805</td>
      <td>0.104</td>
      <td>nM</td>
      <td>Potential transcription error</td>
      <td>COc1ccccc1CN(C)CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>NaN</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Noticed there was an extra index column (named “Unnamed: 0”), likely inherited from how the .csv file was saved, dropping this column for now.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dtree_df <span class="op">=</span> dtree_df.drop(<span class="st">"Unnamed: 0"</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dtree_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEMBL11805</td>
      <td>0.104</td>
      <td>nM</td>
      <td>Potential transcription error</td>
      <td>COc1ccccc1CN(C)CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>NaN</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="calculate-pki" class="level5">
<h5 class="anchored" data-anchor-id="calculate-pki"><strong>Calculate pKi</strong></h5>
<p>The distribution of Ki values were shown below via a simple statistical summary.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dtree_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ki</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.400000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.544039e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.103437e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.700000e-03</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.437500e+01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.995000e+02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.100000e+03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.496300e+07</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>From the above quick statistical summary and also the code below to find the minimum Ki value, it confirmed that there were no zero Ki values recorded.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dtree_df[<span class="st">"Ki"</span>].<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0.0017</code></pre>
</div>
</div>
<p>Now we could convert the Ki values to pKi values, which were the negative logs of Ki in molar units (a <a href="https://pubchem.ncbi.nlm.nih.gov/bioassay/213088">PubChem example</a> might help to explain it a little further). The key to understand pKi here was to treat pKi similarly to how we would normally understand pH for our acids and bases. The formula to convert Ki to pKi for nanomolar (nM) units was:</p>
<p><span class="math display">\[
\text{pKi} = 9 - log _{10}(Ki)
\]</span></p>
<p>Set up a small function to do the conversion.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_pKi(Ki):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    pKi_value <span class="op">=</span> <span class="dv">9</span> <span class="op">-</span> math.log10(Ki)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pKi_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Applying the calc_pKi function to convert all rows of the compound dataset for the “Ki” column (please scroll to the very right to see it).</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column for pKi</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply calc_pKi function to the data in Ki column</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dtree_df[<span class="st">"pKi"</span>] <span class="op">=</span> dtree_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: calc_pKi(x.Ki), axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataframe would now look like this, with a new pKi column.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dtree_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEMBL11805</td>
      <td>0.104</td>
      <td>nM</td>
      <td>Potential transcription error</td>
      <td>COc1ccccc1CN(C)CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)...</td>
      <td>9.982967</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>10.585027</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>8.787812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>NaN</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>6.821023</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>NaN</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>7.913640</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="plan-other-data-pre-processing-steps" class="level5">
<h5 class="anchored" data-anchor-id="plan-other-data-pre-processing-steps"><strong>Plan other data pre-processing steps</strong></h5>
<p>However, for a decision tree model, a few more molecular descriptors were most likely needed rather than only Ki or pKi and SMILES. One way to do this could be through computations based on canonical SMILES of compounds by using RDKit to add some molecular descriptors.</p>
<p>However, before doing this, a compound sanitisation step should be applied before starting any calculations to rule out compounds with questionable chemical validities. RDKit or Datamol (a Python wrapper library built based on RDKit) was also capable of doing this.</p>
<p>I’ve added a quick step here to convert the data types of “smiles” and “data_validity_comment” columns to string (in case of running into problems later).</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dtree_df <span class="op">=</span> dtree_df.astype({<span class="st">"smiles"</span>: <span class="st">"string"</span>, <span class="st">"data_validity_comment"</span>: <span class="st">"string"</span>})</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dtree_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>molecule_chembl_id        object
Ki                       float64
units                     object
data_validity_comment     string
smiles                    string
pKi                      float64
dtype: object</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="check-data-validity" class="level5">
<h5 class="anchored" data-anchor-id="check-data-validity"><strong>Check data validity</strong></h5>
<p>Also, before jumping straight to compound sanitisation, I remembered that I needed to check the “data_validity_comment” column.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dtree_df[<span class="st">"data_validity_comment"</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;StringArray&gt;
['Potential transcription error', &lt;NA&gt;, 'Outside typical range']
Length: 3, dtype: string</code></pre>
</div>
</div>
<p>There were 3 different types of data validity comments found, which were “NaN”, “Outside typical range” and “Potential transcirption error”. So, this meant compounds with comments other than “NaN” would need to be addressed first.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out number of compounds with "outside typical range" as data validity comment</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dtree_df_err <span class="op">=</span> dtree_df[dtree_df[<span class="st">"data_validity_comment"</span>] <span class="op">==</span> <span class="st">"Outside typical range"</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_df_err.shape)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dtree_df_err.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(58, 6)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>111</th>
      <td>CHEMBL225198</td>
      <td>0.0090</td>
      <td>nM</td>
      <td>Outside typical range</td>
      <td>O=C(CCc1c[nH]c2ccccc12)NCCCCCCCNc1c2c(nc3cc(Cl...</td>
      <td>11.045757</td>
    </tr>
    <tr>
      <th>114</th>
      <td>CHEMBL225021</td>
      <td>0.0017</td>
      <td>nM</td>
      <td>Outside typical range</td>
      <td>O=C(CCCc1c[nH]c2ccccc12)NCCCCCNc1c2c(nc3cc(Cl)...</td>
      <td>11.769551</td>
    </tr>
    <tr>
      <th>118</th>
      <td>CHEMBL402976</td>
      <td>313700.0000</td>
      <td>nM</td>
      <td>Outside typical range</td>
      <td>CN(C)CCOC(=O)Nc1ccncc1</td>
      <td>3.503485</td>
    </tr>
    <tr>
      <th>119</th>
      <td>CHEMBL537454</td>
      <td>140200.0000</td>
      <td>nM</td>
      <td>Outside typical range</td>
      <td>CN(C)CCOC(=O)Nc1cc(Cl)nc(Cl)c1.Cl</td>
      <td>3.853252</td>
    </tr>
    <tr>
      <th>120</th>
      <td>CHEMBL3216883</td>
      <td>316400.0000</td>
      <td>nM</td>
      <td>Outside typical range</td>
      <td>CN(C)CCOC(=O)Nc1ccncc1Br.Cl.Cl</td>
      <td>3.499764</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There were a total of 58 compounds with Ki outside typical range.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out number of compounds with "potential transcription error" as data validity comment</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>dtree_df[dtree_df[<span class="st">"data_validity_comment"</span>] <span class="op">==</span> <span class="st">"Potential transcription error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEMBL11805</td>
      <td>0.104</td>
      <td>nM</td>
      <td>Potential transcription error</td>
      <td>COc1ccccc1CN(C)CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)...</td>
      <td>9.982967</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There was one compound with potential transcription errors for Ki value.</p>
<p>These compounds with questionable Ki values were removed, as they could be potential sources of errors for ML models later on (error trickling effect). One of the ways I thought of doing was to fill the empty cells within the “data_validity_comment” column first, so it would be easier to filter them out.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill "NaN" entries with an actual name e.g. zero</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dtree_df <span class="op">=</span> dtree_df.fillna(<span class="st">"none"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>dtree_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEMBL11805</td>
      <td>0.104</td>
      <td>nM</td>
      <td>Potential transcription error</td>
      <td>COc1ccccc1CN(C)CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)...</td>
      <td>9.982967</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>none</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>10.585027</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>8.787812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>none</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>6.821023</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>none</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>7.913640</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Filtered out only the compounds with nil data validity comments.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dtree_df["data_validity_comment"].unique()</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dtree_df <span class="op">=</span> dtree_df[dtree_df[<span class="st">"data_validity_comment"</span>] <span class="op">==</span> <span class="st">"none"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checking the dtree_df dataframe again and also whether if only the compounds with “none” labelled for “data_validity_comment” column were kept (and other two types were removed).</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_df.shape)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dtree_df[<span class="st">"data_validity_comment"</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 6)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;StringArray&gt;
['none']
Length: 1, dtype: string</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="sanitise-compounds" class="level4">
<h4 class="anchored" data-anchor-id="sanitise-compounds"><strong>Sanitise compounds</strong></h4>
<p>I’ve found the <a href="https://docs.datamol.io/stable/tutorials/Preprocessing.html">pre-processing molecules tutorial</a> and its reference links provided by Datamol to be very informative. Each steps of fix_mol(), sanitize_mol() and standardize_mol() were explained in the link provided above. I guess the key was to select pre-processing options required to fit the purpose of the ML models being built later on, and more experiences in doing so would hopefully help with improving the compound pre-processing step.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _preprocess function to sanitise compounds - adapted from datamol.io</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>smiles_column <span class="op">=</span> <span class="st">"smiles"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dm.disable_rdkit_log()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _preprocess(row):</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert each compound to a RDKit molecule in the smiles column</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    mol <span class="op">=</span> dm.to_mol(row[smiles_column], ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix common errors in the molecules</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    mol <span class="op">=</span> dm.fix_mol(mol)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sanitise the molecules </span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    mol <span class="op">=</span> dm.sanitize_mol(mol, sanifix<span class="op">=</span><span class="va">True</span>, charge_neutral<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Standardise the molecules</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    mol <span class="op">=</span> dm.standardize_mol(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        mol,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Switch on to disconnect metal ions</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        disconnect_metals<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        normalize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        reionize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Switch on "uncharge" to neutralise charges</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        uncharge<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Taking care of stereochemistries of compounds</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        stereo<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Added a new column below for RDKit molecules</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">"rdkit_mol"</span>] <span class="op">=</span> dm.to_mol(mol)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">"standard_smiles"</span>] <span class="op">=</span> dm.standardize_smiles(dm.to_smiles(mol))</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">"selfies"</span>] <span class="op">=</span> dm.to_selfies(mol)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">"inchi"</span>] <span class="op">=</span> dm.to_inchi(mol)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">"inchikey"</span>] <span class="op">=</span> dm.to_inchikey(mol)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then the compound sanitisation function was applied to the dtree_df.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df <span class="op">=</span> dtree_df.<span class="bu">apply</span>(_preprocess, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>dtree_san_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
      <th>rdkit_mol</th>
      <th>standard_smiles</th>
      <th>selfies</th>
      <th>inchi</th>
      <th>inchikey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>none</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>10.585027</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf4c0&gt;</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>[C][C][C][=C][C][C][C][=N][C][=C][C][Branch1][...</td>
      <td>InChI=1S/C18H19ClN2/c1-2-10-5-11-7-12(6-10)17-...</td>
      <td>QTPHSDHUHXUYFE-KIYNQFGBSA-N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>8.787812</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf840&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.BrH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>CAEPIUXAUPYIIJ-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>none</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>6.821023</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddeff0&gt;</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>[N][C][=C][C][=Branch1][N][=N][C][=C][C][=C][C...</td>
      <td>InChI=1S/C13H14N2/c14-13-9-5-1-3-7-11(9)15-12-...</td>
      <td>YLJREFDVOIBQDA-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>none</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>7.913640</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf060&gt;</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>[C][C][N][Branch2][Branch1][Ring1][C][C][C][C]...</td>
      <td>InChI=1S/C42H70N4O4/c1-7-45(35-37-25-17-19-27-...</td>
      <td>VJXLWYGKZGTXAF-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CHEMBL1128</td>
      <td>200.000</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>6.698970</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf760&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.ClH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>BXKDSDJJOVIHMX-UHFFFAOYSA-N</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Please note if the dataset required for sanitisation is large, Datamol has suggested using their example code to add parallelisation as shown below.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Code adapted from: https://docs.datamol.io/stable/tutorials/Preprocessing.html#references</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>data_clean <span class="op">=</span> dm.parallelized(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    _preprocess, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    data.iterrows(), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    arg_type<span class="op">=</span><span class="st">"args"</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    total<span class="op">=</span><span class="bu">len</span>(data)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>data_clean <span class="op">=</span> pd.DataFrame(data_clean)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(481, 11)</code></pre>
</div>
</div>
<p>In this case, I tried using the preprocessing function without adding the parallelisation, the whole sanitisation process wasn’t very long (since I had a small dataset), and was done within a minute or so.</p>
<p><br></p>
</section>
<section id="detect-outliers" class="level4">
<h4 class="anchored" data-anchor-id="detect-outliers"><strong>Detect outliers</strong></h4>
<p>Plotting a histogram to see the distribution of pKi values first.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df.hist(column <span class="op">=</span> <span class="st">"pKi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([[&lt;AxesSubplot: title={'center': 'pKi'}&gt;]], dtype=object)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Data_prep_2_files/figure-html/cell-20-output-2.png" width="575" height="431"></p>
</div>
</div>
<p>I read a bit about Dixon’s Q test and realised that there were a few required assumptions prior to using this test, and the current dataset used here (dtree_san_df) might not fit the requirements, which were:</p>
<ul>
<li>normally distributed data</li>
<li>a small sample size e.g.&nbsp;between 3 and 10, which was originally stated in this paper <span class="citation" data-cites="dean1951">(<a href="#ref-dean1951" role="doc-biblioref">Dean and Dixon 1951</a>)</span>.</li>
</ul>
<p>So I’ve decided that rather than showing Python code for Dixon’s Q test myself, I’d attach a few examples from others instead, <a href="https://plotly.com/python/v3/outlier-test/">Q test from Plotly</a> and also <a href="https://sebastianraschka.com/Articles/2014_dixon_test.html">Dixon’s Q test for outlier identification – a questionable practice</a>, since this dataset here wasn’t quite normally distributed as shown from the histogram plotted above.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df.boxplot(column <span class="op">=</span> <span class="st">"pKi"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the boxplot version below shows a blank background</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rather than above version with horizontal grid lines</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dtree_san_df.plot.box(column = "pKi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;AxesSubplot: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Data_prep_2_files/figure-html/cell-21-output-2.png" width="566" height="411"></p>
</div>
</div>
<p>I also used Pandas’ built-in boxplot in addition to the histogram to show the possible outliers within the pKi values. Clearly, the outliers for pKi values appeared to be above 10. I’ve also decided not to completely remove these outliers due to the dataset itself being not in a Gaussian distribution (which meant they might not be true outliers).</p>
<p><br></p>
</section>
<section id="calculate-molecular-descriptors" class="level4">
<h4 class="anchored" data-anchor-id="calculate-molecular-descriptors"><strong>Calculate molecular descriptors</strong></h4>
<p>I’ve explored a few different ways to compute molecular descriptors, essentially RDKit was used as the main library to do this. A <a href="https://drzinph.com/rdkit_2d-descriptors-in-python-part-4/">blog post</a> I’ve come across on calculating RDKit 2D molecular descriptors has explained it well, it gave details about how to bundle the functions together in a class (the idea of building a small library yourself to use in projects, which were quite handy). I’ve also read into RDKit’s documentations and also the ones from Datamol. Rather than re-inventing the wheels as there were already several really well-explained blog posts about this, I’d probably opt for Datamol since it was relatively new to me.</p>
<p>With the lastest format of the dtree_san_df, it already included a RDKit molecule column (named “rdkit_mol”), so this meant I could go ahead with the calculations. Without jumping into Datamol directly, I just wanted to try out RDKit’s code first. There was also a useful <a href="https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html">descriptor calculation tutorial</a> written by Greg Landrum about this.</p>
<section id="rdkit-code" class="level6">
<h6 class="anchored" data-anchor-id="rdkit-code"><strong>RDKit code</strong></h6>
<p>This was just one of the code examples in RDKit as there could be more variations of this depending on needs.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the RDKit mol column as an object</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mols_rdkit <span class="op">=</span> dtree_san_df[<span class="st">"rdkit_mol"</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>mols_rdkit</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run descriptor calculations on mols object</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and save as a new list</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>mol_ls <span class="op">=</span> [Descriptors.CalcMolDescriptors(mol) <span class="cf">for</span> mol <span class="kw">in</span> mols_rdkit]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list into a dataframe</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>df_rdkit_2d <span class="op">=</span> pd.DataFrame(mol_ls)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_rdkit_2d.shape)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>df_rdkit_2d.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 209)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MaxAbsEStateIndex</th>
      <th>MaxEStateIndex</th>
      <th>MinAbsEStateIndex</th>
      <th>MinEStateIndex</th>
      <th>qed</th>
      <th>MolWt</th>
      <th>HeavyAtomMolWt</th>
      <th>ExactMolWt</th>
      <th>NumValenceElectrons</th>
      <th>NumRadicalElectrons</th>
      <th>...</th>
      <th>fr_sulfide</th>
      <th>fr_sulfonamd</th>
      <th>fr_sulfone</th>
      <th>fr_term_acetylene</th>
      <th>fr_tetrazole</th>
      <th>fr_thiazole</th>
      <th>fr_thiocyan</th>
      <th>fr_thiophene</th>
      <th>fr_unbrch_alkane</th>
      <th>fr_urea</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.509708</td>
      <td>6.509708</td>
      <td>0.547480</td>
      <td>0.547480</td>
      <td>0.763869</td>
      <td>298.817</td>
      <td>279.665</td>
      <td>298.123676</td>
      <td>108</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.261910</td>
      <td>9.261910</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.662462</td>
      <td>246.148</td>
      <td>230.020</td>
      <td>245.041526</td>
      <td>74</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.199769</td>
      <td>6.199769</td>
      <td>0.953981</td>
      <td>0.953981</td>
      <td>0.706488</td>
      <td>198.269</td>
      <td>184.157</td>
      <td>198.115698</td>
      <td>76</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.614796</td>
      <td>12.614796</td>
      <td>0.269546</td>
      <td>0.269546</td>
      <td>0.079730</td>
      <td>695.046</td>
      <td>624.486</td>
      <td>694.539707</td>
      <td>282</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.261910</td>
      <td>9.261910</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.608112</td>
      <td>201.697</td>
      <td>185.569</td>
      <td>201.092042</td>
      <td>74</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 209 columns</p>
</div>
</div>
</div>
<p>In total, it generated 209 descriptors.</p>
<p><br></p>
</section>
<section id="datamol-code" class="level6">
<h6 class="anchored" data-anchor-id="datamol-code"><strong>Datamol code</strong></h6>
<p>Then I tested Datamol’s code on this as shown below.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert RDKit molecule column into list</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mols_dm <span class="op">=</span> dtree_san_df[<span class="st">"rdkit_mol"</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Datamol's batch descriptor code for a list of compounds</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>dtree_san_df_dm <span class="op">=</span> dm.descriptors.batch_compute_many_descriptors(mols_dm)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_san_df_dm.shape)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>dtree_san_df_dm.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 22)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>mw</th>
      <th>fsp3</th>
      <th>n_lipinski_hba</th>
      <th>n_lipinski_hbd</th>
      <th>n_rings</th>
      <th>n_hetero_atoms</th>
      <th>n_heavy_atoms</th>
      <th>n_rotatable_bonds</th>
      <th>n_radical_electrons</th>
      <th>tpsa</th>
      <th>...</th>
      <th>sas</th>
      <th>n_aliphatic_carbocycles</th>
      <th>n_aliphatic_heterocyles</th>
      <th>n_aliphatic_rings</th>
      <th>n_aromatic_carbocycles</th>
      <th>n_aromatic_heterocyles</th>
      <th>n_aromatic_rings</th>
      <th>n_saturated_carbocycles</th>
      <th>n_saturated_heterocyles</th>
      <th>n_saturated_rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>298.123676</td>
      <td>0.388889</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>21</td>
      <td>1</td>
      <td>0</td>
      <td>38.91</td>
      <td>...</td>
      <td>4.331775</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>245.041526</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>0</td>
      <td>20.23</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>198.115698</td>
      <td>0.307692</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>38.91</td>
      <td>...</td>
      <td>2.014719</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>694.539707</td>
      <td>0.666667</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>50</td>
      <td>29</td>
      <td>0</td>
      <td>65.56</td>
      <td>...</td>
      <td>2.803680</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201.092042</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>0</td>
      <td>20.23</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<p>There were a total of 22 molecular descriptors generated, which seemed more like what I might use for the decision tree model. The types of descriptors were shown below.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df_dm.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Index(['mw', 'fsp3', 'n_lipinski_hba', 'n_lipinski_hbd', 'n_rings',
       'n_hetero_atoms', 'n_heavy_atoms', 'n_rotatable_bonds',
       'n_radical_electrons', 'tpsa', 'qed', 'clogp', 'sas',
       'n_aliphatic_carbocycles', 'n_aliphatic_heterocyles',
       'n_aliphatic_rings', 'n_aromatic_carbocycles', 'n_aromatic_heterocyles',
       'n_aromatic_rings', 'n_saturated_carbocycles',
       'n_saturated_heterocyles', 'n_saturated_rings'],
      dtype='object')</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="combine-dataframes" class="level5">
<h5 class="anchored" data-anchor-id="combine-dataframes"><strong>Combine dataframes</strong></h5>
<p>The trickier part for this second-half of data pre-processing actually lied here - merging/joining/concatenating dataframes of the pre-processed dataframe (dtree_san_df) and Datamol’s descriptor code (dtree_san_df_dm).</p>
<p>Initially, I tried using all of Pandas’ code of merge/join/concat dataframes. They all failed to create the correct final combined dataframe since there were too many rows, with one run actually created 540 rows (maximum should be 481 rows). One of the possible reasons for this could be that some of the descriptors had zeros generated as results for some of the compounds, and when combining using Pandas code like the ones mentioned here, they might cause unexpected results (as suggested by Pandas, they were not exactly equivalent to SQL joins). So I looked into different ways, and while there were no other common columns for both dataframes, the index column seemed to be the only one that correlated both.</p>
<p>I also found out after going back to the previous steps that when I applied the compound pre-processing function from Datamol, the index of the resultant dataframe was changed to start from 1 (rather than zero). Because of this, I tried re-setting the index of dtree_san_df first, then dropped the index column, followed by re-setting the index again to ensure it started at zero, and this worked. So now the dtree_san_df would have exactly the same index as the one for dtree_san_df_dm.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st index re-set</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>dtree_san_df <span class="op">=</span> dtree_san_df.reset_index()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the index column</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>dtree_san_df <span class="op">=</span> dtree_san_df.drop([<span class="st">"index"</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>dtree_san_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
      <th>rdkit_mol</th>
      <th>standard_smiles</th>
      <th>selfies</th>
      <th>inchi</th>
      <th>inchikey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>none</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>10.585027</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf4c0&gt;</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>[C][C][C][=C][C][C][C][=N][C][=C][C][Branch1][...</td>
      <td>InChI=1S/C18H19ClN2/c1-2-10-5-11-7-12(6-10)17-...</td>
      <td>QTPHSDHUHXUYFE-KIYNQFGBSA-N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>8.787812</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf840&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.BrH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>CAEPIUXAUPYIIJ-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>none</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>6.821023</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddeff0&gt;</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>[N][C][=C][C][=Branch1][N][=N][C][=C][C][=C][C...</td>
      <td>InChI=1S/C13H14N2/c14-13-9-5-1-3-7-11(9)15-12-...</td>
      <td>YLJREFDVOIBQDA-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>none</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>7.913640</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf060&gt;</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>[C][C][N][Branch2][Branch1][Ring1][C][C][C][C]...</td>
      <td>InChI=1S/C42H70N4O4/c1-7-45(35-37-25-17-19-27-...</td>
      <td>VJXLWYGKZGTXAF-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHEMBL1128</td>
      <td>200.000</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>6.698970</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf760&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.ClH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>BXKDSDJJOVIHMX-UHFFFAOYSA-N</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd index re-set</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>dtree_san_df <span class="op">=</span> dtree_san_df.reset_index()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_san_df.shape)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>dtree_san_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 12)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>molecule_chembl_id</th>
      <th>Ki</th>
      <th>units</th>
      <th>data_validity_comment</th>
      <th>smiles</th>
      <th>pKi</th>
      <th>rdkit_mol</th>
      <th>standard_smiles</th>
      <th>selfies</th>
      <th>inchi</th>
      <th>inchikey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>CHEMBL208599</td>
      <td>0.026</td>
      <td>nM</td>
      <td>none</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>10.585027</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf4c0&gt;</td>
      <td>CCC1=CC2Cc3nc4cc(Cl)ccc4c(N)c3[C@@H](C1)C2</td>
      <td>[C][C][C][=C][C][C][C][=N][C][=C][C][Branch1][...</td>
      <td>InChI=1S/C18H19ClN2/c1-2-10-5-11-7-12(6-10)17-...</td>
      <td>QTPHSDHUHXUYFE-KIYNQFGBSA-N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>CHEMBL60745</td>
      <td>1.630</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>8.787812</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf840&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Br-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.BrH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>CAEPIUXAUPYIIJ-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>CHEMBL95</td>
      <td>151.000</td>
      <td>nM</td>
      <td>none</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>6.821023</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddeff0&gt;</td>
      <td>Nc1c2c(nc3ccccc13)CCCC2</td>
      <td>[N][C][=C][C][=Branch1][N][=N][C][=C][C][=C][C...</td>
      <td>InChI=1S/C13H14N2/c14-13-9-5-1-3-7-11(9)15-12-...</td>
      <td>YLJREFDVOIBQDA-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>CHEMBL173309</td>
      <td>12.200</td>
      <td>nM</td>
      <td>none</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>7.913640</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf060&gt;</td>
      <td>CCN(CCCCCC(=O)N(C)CCCCCCCCN(C)C(=O)CCCCCN(CC)C...</td>
      <td>[C][C][N][Branch2][Branch1][Ring1][C][C][C][C]...</td>
      <td>InChI=1S/C42H70N4O4/c1-7-45(35-37-25-17-19-27-...</td>
      <td>VJXLWYGKZGTXAF-UHFFFAOYSA-N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>CHEMBL1128</td>
      <td>200.000</td>
      <td>nM</td>
      <td>none</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>6.698970</td>
      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x120ddf760&gt;</td>
      <td>CC[N+](C)(C)c1cccc(O)c1.[Cl-]</td>
      <td>[C][C][N+1][Branch1][C][C][Branch1][C][C][C][=...</td>
      <td>InChI=1S/C10H15NO.ClH/c1-4-11(2,3)9-6-5-7-10(1...</td>
      <td>BXKDSDJJOVIHMX-UHFFFAOYSA-N</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Also re-setting the index of the dtree_san_df_dm.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dtree_san_df_dm <span class="op">=</span> dtree_san_df_dm.reset_index()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_san_df_dm.shape)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>dtree_san_df_dm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 23)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>mw</th>
      <th>fsp3</th>
      <th>n_lipinski_hba</th>
      <th>n_lipinski_hbd</th>
      <th>n_rings</th>
      <th>n_hetero_atoms</th>
      <th>n_heavy_atoms</th>
      <th>n_rotatable_bonds</th>
      <th>n_radical_electrons</th>
      <th>...</th>
      <th>sas</th>
      <th>n_aliphatic_carbocycles</th>
      <th>n_aliphatic_heterocyles</th>
      <th>n_aliphatic_rings</th>
      <th>n_aromatic_carbocycles</th>
      <th>n_aromatic_heterocyles</th>
      <th>n_aromatic_rings</th>
      <th>n_saturated_carbocycles</th>
      <th>n_saturated_heterocyles</th>
      <th>n_saturated_rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>298.123676</td>
      <td>0.388889</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>21</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>4.331775</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>245.041526</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>198.115698</td>
      <td>0.307692</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>2.014719</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>694.539707</td>
      <td>0.666667</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>50</td>
      <td>29</td>
      <td>0</td>
      <td>...</td>
      <td>2.803680</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>201.092042</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>13</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>476</th>
      <td>476</td>
      <td>377.231456</td>
      <td>0.600000</td>
      <td>7</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>27</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>2.079621</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>477</th>
      <td>477</td>
      <td>391.247107</td>
      <td>0.619048</td>
      <td>7</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>28</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>2.651646</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>478</th>
      <td>478</td>
      <td>311.152144</td>
      <td>0.315789</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>23</td>
      <td>4</td>
      <td>0</td>
      <td>...</td>
      <td>2.423278</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>479</th>
      <td>479</td>
      <td>368.096076</td>
      <td>0.923077</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>18</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>4.476639</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>480</th>
      <td>480</td>
      <td>246.136828</td>
      <td>0.500000</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>18</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>3.223652</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>481 rows × 23 columns</p>
</div>
</div>
</div>
<p>Merged both dataframes of dtree_san_df and dtree_san_df_dm based on both of their indices.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge dtree_san_df &amp; dtree_san_df_dm</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>dtree_f_df <span class="op">=</span> pd.merge(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    dtree_san_df[[<span class="st">"index"</span>, <span class="st">"molecule_chembl_id"</span>, <span class="st">"pKi"</span>]],</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    dtree_san_df_dm,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check final dataframe to make sure there were 481 rows and increased columns (combined numbers of columns from both dataframes). So this finally seemed to work.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtree_f_df.shape)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>dtree_f_df.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(481, 26)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index_x</th>
      <th>molecule_chembl_id</th>
      <th>pKi</th>
      <th>index_y</th>
      <th>mw</th>
      <th>fsp3</th>
      <th>n_lipinski_hba</th>
      <th>n_lipinski_hbd</th>
      <th>n_rings</th>
      <th>n_hetero_atoms</th>
      <th>...</th>
      <th>sas</th>
      <th>n_aliphatic_carbocycles</th>
      <th>n_aliphatic_heterocyles</th>
      <th>n_aliphatic_rings</th>
      <th>n_aromatic_carbocycles</th>
      <th>n_aromatic_heterocyles</th>
      <th>n_aromatic_rings</th>
      <th>n_saturated_carbocycles</th>
      <th>n_saturated_heterocyles</th>
      <th>n_saturated_rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>CHEMBL208599</td>
      <td>10.585027</td>
      <td>0</td>
      <td>298.123676</td>
      <td>0.388889</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>...</td>
      <td>4.331775</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>CHEMBL60745</td>
      <td>8.787812</td>
      <td>1</td>
      <td>245.041526</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>CHEMBL95</td>
      <td>6.821023</td>
      <td>2</td>
      <td>198.115698</td>
      <td>0.307692</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>2.014719</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>CHEMBL173309</td>
      <td>7.913640</td>
      <td>3</td>
      <td>694.539707</td>
      <td>0.666667</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>...</td>
      <td>2.803680</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>CHEMBL1128</td>
      <td>6.698970</td>
      <td>4</td>
      <td>201.092042</td>
      <td>0.400000</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>3.185866</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>CHEMBL102226</td>
      <td>4.698970</td>
      <td>5</td>
      <td>297.152928</td>
      <td>0.923077</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>...</td>
      <td>2.965170</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>CHEMBL103873</td>
      <td>5.698970</td>
      <td>6</td>
      <td>269.121628</td>
      <td>0.909091</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>...</td>
      <td>3.097106</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>CHEMBL640</td>
      <td>6.000000</td>
      <td>7</td>
      <td>235.168462</td>
      <td>0.461538</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>...</td>
      <td>1.791687</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>CHEMBL75121</td>
      <td>7.663540</td>
      <td>8</td>
      <td>415.178358</td>
      <td>0.192308</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>...</td>
      <td>2.117241</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>CHEMBL502</td>
      <td>7.688246</td>
      <td>9</td>
      <td>379.214744</td>
      <td>0.458333</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>2.677222</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 26 columns</p>
</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-dean1951" class="csl-entry" role="doc-biblioentry">
Dean, R. B., and W. J. Dixon. 1951. <span>“Simplified Statistics for Small Numbers of Observations.”</span> <em>Analytical Chemistry</em> 23 (4): 636–38. <a href="https://doi.org/10.1021/ac60052a025">https://doi.org/10.1021/ac60052a025</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="jhylin/Data_in_life_blog" data-repo-id="R_kgDOHw7lGQ" data-category="General" data-category-id="DIC_kwDOHw7lGc4CQzQ_" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Website made with ❤️ in <a href="https://quarto.org/">Quarto</a> by Jennifer HY Lin © 2022 - 2023 📕 Citation as author and URL link if used</div>
  </div>
</footer>



</body></html>